
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Peter&#39;s Place">
    <title>Web Auth &amp; Security ğŸ‘®â€â™‚ï¸ Part. 3 - Peter&#39;s Place</title>
    <meta name="author" content="Peter Cha">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4926107872672843"
     crossorigin="anonymous"></script>
    
        <meta name="keywords" content="tutorial,authentication,token,session,cookies,XSS,CSRF,SSRF">
    
    
        <link rel="icon" href="https://petercha90.github.io/assets/images/pp.webp">
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Peter Cha","sameAs":[],"image":"peter.webp"},"articleBody":"\n\n\n\n\nì•ˆë…•í•˜ì„¸ìš”, PETERì…ë‹ˆë‹¤.ğŸ‘‹ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” Part. 1ê³¼ Part. 2 ë‚´ìš©ì„ ëª¨ë‘ ì´í•´í•˜ê³  ìˆë‹¤ëŠ” ì „ì œ í•˜ì—, ì›¹ ì·¨ì•½ì ë“¤ì„ ì¿ í‚¤ ì„¸ì…˜ í† í°ì„ ê°€ì§€ê³  ì–´ë–»ê²Œ ì¡°ì¹˜í•  ìˆ˜ ìˆëŠ”ì§€. Part. 2ì—ì„œ ë‚˜ëˆ„ì§€ ëª»í–ˆë˜ ë°©ë²•ë“¤ì„ ë” ì•Œì•„ë³´ê¸°ë¡œ í•˜ê² ìŠµë‹ˆë‹¤.ğŸ¤—\n\n\n\n1. XSS (Cross-Site Scripting) ë°©ì§€&nbsp;&nbsp; ğŸ¥  ì¿ í‚¤ ê´€ë ¨ ë³´ì•ˆ ì„¤ì •\nPart. 1ì—ì„œ Cookieë¥¼ ì„¤ëª…í•˜ë©´ì„œ, ê°œë°œìë„êµ¬ - Consoleì°½ì—ì„œ document.cookieë¼ëŠ” JavaScriptë¥¼ ì…ë ¥í•˜ë©´ ë°”ë¡œ ë¸Œë¼ìš°ì €ì— ì €ì¥ëœ Cookieë“¤ì´ ëª¨ë‘ ì¶œë ¥ì´ ëœë‹¤ëŠ” ì‚¬ì‹¤! ê¸°ì–µë‚˜ì‹œë‚˜ìš”?!\n\nì´ ë§ì¸ì¦‰ìŠ¨, XSS ì·¨ì•½ì ì´ ìˆëŠ” ê²½ìš°, JavaScriptë¥¼ ì‚¬ìš©í•´ì„œ ì¿ í‚¤ ì •ë³´ë¥¼ í•´ì»¤ê°€ íƒˆì·¨í•  ìˆ˜ ìˆë‹¤ëŠ” ë§ì´ ë©ë‹ˆë‹¤!ğŸ™€ í•˜ì§€ë§Œ XSS ì·¨ì•½ì ì´ ìˆëŠ” ìƒí™©ì—ë„ ì¿ í‚¤ì— JavaScriptë¥¼ ì‚¬ìš©í•´ì„œ ì¿ í‚¤ ë‚´ìš©ì— ì ‘ê·¼í•  ìˆ˜ ì—†ê²Œí•˜ëŠ” ë°©ë²•ì´ ìˆìœ¼ë‹ˆ, ë°”ë¡œ HttpOnlyì™€, Secure ì„¤ì • ë˜ì‹œê² ìŠµë‹ˆë‹¤.ğŸ˜\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;1. HttpOnly ğŸ¤«\nì•„ë˜ì™€ ê°™ì´ Cookieë¥¼ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ë³´ë‚´ì¤„ ë•Œ, HttpOnly ì„¤ì •ì„ í•´ì£¼ë©´ ì‹¤ì œë¡œëŠ” í•´ë‹¹ ì¿ í‚¤ê°€ ë¸Œë¼ìš°ì €ì— ì €ì¥ì´ ì˜ ëì§€ë§Œ, í´ë¼ì´ì–¸íŠ¸ì¸ ë¸Œë¼ìš°ì € ë‹¨ì—ì„œëŠ” console.log(document.cookie) ë“±ê³¼ ê°™ì´ JavaScriptë¡œ ì¶œë ¥í•´ë„ ì•„ë¬´ê²ƒë„ ì¶œë ¥ë˜ì§€ ì•Šì•„ ì¿ í‚¤ ë‚´ìš©ì„ ì•Œ ìˆ˜ ì—†ê²Œ ë©ë‹ˆë‹¤! ğŸ‘\n\n&nbsp;&nbsp;Set-Cookie: sessionid&#x3D;abc123; HttpOnly\n\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;2. Secure ğŸ‘®\nSecure ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´, Httpsë¡œ ì¸ì¦ëœ ì‚¬ì´íŠ¸ì—ì„œë§Œ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ(&#x3D;ë¸Œë¼ìš°ì €ì—ì„œ ì„œë²„ë¡œ ì „ì†¡í•  ìˆ˜ ìˆê²Œ)í•´ì¤˜ì„œ, ë³´ì•ˆì´ ì·¨ì•½í•œ HTTP ì‚¬ì´íŠ¸ì—ì„œëŠ” ì¿ í‚¤ê°€ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•´ì£¼ë©´ í•´ì»¤ê°€ íƒˆì·¨í•œë‹¤í•œë“¤ ì‚¬ìš©í•  ìˆ˜ ì—†ê² ì£ ? ğŸ˜¼\n\n&nbsp;&nbsp;Set-Cookie: sessionid&#x3D;abc123; Secure\n\n\n\n&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example âœï¸\nê·¸ë ‡ë‹¤ë©´ HttpOnly, Secure ì˜µì…˜ë“¤ì€ ì–´ë””ì„œ ì„¤ì •í•´ì•¼ í• ê¹Œìš”? ì •ë³´ë¥¼ ë‹´ì•„ì„œ ë³´ë‚´ì£¼ëŠ” ì„œë²„ê°€ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤! ì•„ë˜ëŠ” ë‘ ì˜µì…˜ì„ ì ìš©í•˜ëŠ” ë‘ ê°€ì§€ SpringBoot ì˜ˆì‹œì—ìš”. ë§ˆì°¬ê°€ì§€ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ì„œë²„ê°€ Djangoë“ , node.jsë“  í•´ë‹¹ ì„œë²„ì˜ ë°©ì‹ëŒ€ë¡œ ì•„ë˜ì™€ ê°™ì´ ì¿ í‚¤ì— ì„¤ì •ì„ í•´ì¤˜ì„œ ë³´ë‚´ì£¼ë©´ ë˜ê² ì£ ?\nSpring Securityë¥¼ ì‚¬ìš©í•˜ë©´ ìë™ìœ¼ë¡œ JSESSIONID ì¿ í‚¤ì— HttpOnly ì†ì„±ì´ ì ìš©ëœë‹¤ê³ í•˜ë‹ˆ, ì°¸ê³ í•˜ì„¸ìš”!ğŸ˜‰\n\n  springbootjavaimport jakarta.servlet.http.Cookie;import jakarta.servlet.http.HttpServletResponse;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RestController;@RestControllerpublic class CookieController {    @GetMapping(\"/set-cookie\")    public String setCookie(HttpServletResponse response) {        Cookie cookie = new Cookie(\"sessionID\", \"123456\"); // ì¿ í‚¤ ì´ë¦„ê³¼ ê°’ ì„¤ì •        cookie.setHttpOnly(true); // HttpOnly ì†ì„± ì„¤ì • (JavaScriptì—ì„œ ì ‘ê·¼ ë¶ˆê°€ëŠ¥)        cookie.setSecure(true); // HTTPS í™˜ê²½ì—ì„œë§Œ ì¿ í‚¤ ì „ì†¡ (ë³´ì•ˆ ê°•í™”)        cookie.setPath(\"/\"); // ì¿ í‚¤ê°€ ì „ì²´ ë„ë©”ì¸ì—ì„œ ìœ íš¨í•˜ë„ë¡ ì„¤ì •        cookie.setMaxAge(60 * 60); // ì¿ í‚¤ ìœ íš¨ ì‹œê°„: 1ì‹œê°„ (ì´ˆ ë‹¨ìœ„)        response.addCookie(cookie); // ì‘ë‹µì— ì¿ í‚¤ ì¶”ê°€        return \"HttpOnly ì¿ í‚¤ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!\";    }    // ìœ„ì— setCookieì™€ ì•„ë˜ setCookieWithHeaderëŠ” ë˜‘ê°™ì€ ê²°ê³¼. ë‘˜ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©    @GetMapping(\"/set-cookie-header\")    public String setCookieWithHeader(HttpServletResponse response) {        response.setHeader(\"Set-Cookie\",             \"sessionID=123456; HttpOnly; Secure; Path=/; Max-Age=3600\");        return \"HttpOnly ì¿ í‚¤ê°€ ì‘ë‹µ í—¤ë”ì— ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!\";    }}\n\n&nbsp;&nbsp;&nbsp;&nbsp;3. Content Security Policy(CSP) ì ìš© ğŸ«°\nì›¹ì‚¬ì´íŠ¸ì— ì•„ë˜ì˜ &lt;meta&gt; tagë¥¼ í•œ ì¤„ ë„£ì–´ì£¼ëŠ” ì£¼ëŠ” ê²ƒìœ¼ë¡œë„, ê¸°ë³¸ì ì¸ XSSë¥¼ ì˜ˆë°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.ğŸ«¡ ì½”ë“œì˜ ì„¸ë¶€ì ì¸ ì˜ë¯¸ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. \n  csphtml&lt;meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self' https://apis.trusteddomain.com\"&gt;\n\nhttp-equiv=&quot;Content-Security-Policy&quot; \n\nğŸ‘‰ ë¸Œë¼ìš°ì €ì—ê²Œ CSP ì •ì±…ì„ ì ìš©í•˜ë¼ê³  ì§€ì‹œí•¨.\n\n content=&quot;...&quot;\n\nğŸ‘‰ ì ìš©í•  CSP ì •ì±…ì„ ì •ì˜.\n\n default-src &#39;self&#39;\n\nğŸ‘‰ í˜„ì¬ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” ë¦¬ì†ŒìŠ¤(ìŠ¤í¬ë¦½íŠ¸, ì´ë¯¸ì§€, ìŠ¤íƒ€ì¼ ë“±)ë§Œ ë¡œë“œ ê°€ëŠ¥.&nbsp;&nbsp; ì™¸ë¶€ ë„ë©”ì¸ì—ì„œ ë¡œë“œí•˜ëŠ” ë¦¬ì†ŒìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì°¨ë‹¨ë¨. \n\n script-src &#39;self&#39; https://apis.trusteddomain.com\n\nğŸ‘‰&nbsp;&nbsp;â€™selfâ€™ - í˜„ì¬ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë§Œ í—ˆìš©.ğŸ‘‰&nbsp;&nbsp;https://apis.trusteddomain.com - ì´ íŠ¹ì • ì™¸ë¶€ ë„ë©”ì¸ì—ì„œ ì œê³µí•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ëŠ” í—ˆìš©.     ë‹¤ë¥¸ ì™¸ë¶€ ë„ë©”ì¸ì˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì°¨ë‹¨ë¨.\n\n\në” ë§ì€ ì˜µì…˜ë“¤ì´ ìˆì§€ë§Œ, CSPëŠ” ì´ì •ë„ë§Œ ì•Œì•„ë³´ê¸°ë¡œ í•˜ê² ìŠµë‹ˆë‹¤!\n\n\n\n\n2. CSRF (Cross-Site Request Forgery) ë°©ì§€\nì, ì´ë²ˆì—” CSRF ê³µê²©ì„ ë°©ì§€í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì‚´í´ ë³´ê² ìŠµë‹ˆë‹¤. Part. 2ì—ì„œ CSRFë¥¼ ë°©ì–´í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì„¤ëª…ë“œë ¸ë˜ Referer ì²´í¬í•˜ê¸°ëŠ” CSRF ê³µê²©ì´ ì•„ë‹Œë°ë„ Refererê°€ ì‹¤ì œë¡œ ì—†ëŠ” ê²½ìš°ê°€ ìˆì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—. í•­ìƒ CSRF ê³µê²©ì¸ì§€ ì—¬ë¶€ë¥¼ ë°˜ë³„í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ì•„ë‹™ë‹ˆë‹¤.ğŸ™…\nì‚¬ìš©ìê°€ ì§ì ‘ URLì„ ì…ë ¥í•´ì„œ ìµœì´ˆ ì…ë ¥ì„ í•˜ëŠ” ê²½ìš°, ìµœì´ˆ ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í–ˆê¸° ë•Œë¬¸ì— Refererê°€ ì—†ì„ ìˆ˜ ìˆê³ , ê³ ê°ì˜ ê°œì¸ì •ë³´ì— ë¯¼ê°í•œ ì‚¬ì´íŠ¸ë“¤ì€ ê³ ê°ì˜ í–‰ë™ì„ ì¶”ì í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ë•Œë¬¸ì— Refererë¥¼ ë‚ ë ¤ë²„ë¦´ ìˆ˜ë„ ìˆì–´ìš”.ğŸ«¢ \nì´ëŸ° ê²½ìš°ê¹Œì§€ë„ ëª¨ë‘ Refererê°€ ì—†ë‹¤ê³  CSRF ê³µê²©ìœ¼ë¡œ ê°„ì£¼í•´ì„œëŠ” ì•ˆë˜ê² ì£ ? ê·¸ë˜ì„œ ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ë“¤ì„ ì‚¬ìš©í•´ì„œ CSRFë¥¼ ë°©ì–´í•©ë‹ˆë‹¤.\n\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;1. CSRF í† í° ì‚¬ìš© ğŸ«\nê°€ì¥ íš¨ê³¼ì ìœ¼ë¡œ CSRF ê³µê²©ì„ ë°©ì§€ í•˜ëŠ” ë°©ë²•ì€ í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚´ëŠ” ëª¨ë“  ìš”ì²­ì— ì„œë²„ê°€ ìƒì„±í•œ CSRF í† í°ì„ í¬í•¨í•´ì•¼ë§Œ ì²˜ë¦¬ë˜ë„ë¡ ì„¤ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤!\nTokenì€ ê¸°ë³¸ì ìœ¼ë¡œ ì•„ì£¼ ê¸´ ë¬¸ìì—´ì˜ í˜•íƒœë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³  í–ˆì—ˆì£ ! ì„œë²„ëŠ” ëœë¤&#x2F;ë³µì¡í•œ ê·œì¹™ìœ¼ë¡œ ì´ CSRF í† í°ì„ ìƒì„±í•˜ì—¬ ì•„ë˜ì˜ ìˆœì„œë¡œ CSRF í† í°ì„ ê²€ì¦í•©ë‹ˆë‹¤. \n\nìœ ì €ê°€ ë¡œê·¸ì¸í•  ë•Œ Sessionì •ë³´ì™€ í•¨ê»˜ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•˜ê³ ,\níŠ¹ì • APIê°€ ì‹¤í–‰ë  ë•Œ(e.g. ì†¡ê¸ˆí•˜ê¸°)ëŠ” ë°›ì•˜ë˜ CSRF í† í°ì„ í•­ìƒ í•¨ê»˜ ë„£ì–´ì¤ë‹ˆë‹¤.\nì„œë²„ê°€ Clientë¡œë¶€í„° ë°›ì€ CSRF í† í°ì„ ì„œë²„ì˜ í† í°ê³¼ ë¹„êµ&amp;ì¸ì¦ì´ ì„±ê³µí•˜ë©´ í•´ë‹¹ ìš”ì²­ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\n\n\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ì–´..? ê·¼ë° ì ê¹ë§Œ.\nì, ê·¼ë° ë°”ë¡œ ì—¬ê¸°ì„œ..! ì—¬ê¸°ê¹Œì§€ ì˜ ë”°ë¼ì˜¤ì‹  ë¶„ë“¤ì´ë¼ë©´ ì´ëŸ° ì§ˆë¬¸ì´ ë“œì‹¤ ìˆ˜ë„ ìˆìœ¼ì‹¤ê±°ì—ìš”. \n&nbsp;&nbsp; ???: â€œì•„ë‹ˆ.. ê·¼ë° ê·¸ CSRF í† í°ë„ XSS ê³µê²©ìœ¼ë¡œ í„¸ë¦¬ë©´(?).. í•´ì»¤ê°€ CSRF í† í°ë„ ì‚¬ìš©í•˜ê³  ìœ ì € ì¿ í‚¤ë„ ì‚¬ìš©í•´ì„œ CSRF ë°©ì–´ê°€ ì•ˆë˜ëŠ” ê±° ì•„ë‹Œê°€..??â€ğŸ¤”\n\n\nê·¸ë ‡ìŠµë‹ˆë‹¤.. ê·¸ë ‡ê¸° ë•Œë¬¸ì— CSRF í† í°ì„ ì„œë²„ê°€ ë¸Œë¼ìš°ì €(=Front-end)ë¡œ ì „ë‹¬í•  ë•Œì—ëŠ” ê¼­, HttpOnly + Secure ì¿ í‚¤ë¡œ ê¼­ ì „ë‹¬í•´ì•¼í•©ë‹ˆë‹¤!! JavaScriptë¡œ íƒˆì·¨í•˜ë”ë¼ë„ í† í° ë‚´ìš©ì´ ë¬´ì—‡ì¸ì§€ ì•Œ ìˆ˜ ì—†ë„ë¡ ë§ì´ì£ ! (ìœ„ì—ì„œ ë¨¼ì € ì„¤ëª…í•œ ì´ìœ ..í›„í›„..ğŸ˜)\n\n&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example âœï¸\nSpringBootì—ì„œ CSRF í† í°ì„ ì•ˆì „í•˜ê²Œ ì¿ í‚¤ë¡œ ì „ë‹¬í•˜ëŠ” ì˜ˆì‹œì½”ë“œì…ë‹ˆë‹¤. :)\n  springbootjavaimport org.springframework.http.ResponseCookie;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RestController;import jakarta.servlet.http.HttpServletResponse;@RestControllerpublic class CsrfController {        @GetMapping(\"/api/csrf-token\")    public String getCsrfToken(HttpServletResponse response) {        String csrfToken = generateSecureToken(); // CSRF í† í° ìƒì„±        ResponseCookie cookie = ResponseCookie.from(\"XSRF-TOKEN\", csrfToken)            .httpOnly(true)  // JavaScriptì—ì„œ ì ‘ê·¼ ë¶ˆê°€            .secure(true)    // HTTPSì—ì„œë§Œ ì „ì†¡            .sameSite(\"Strict\") // ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œëŠ” ì‚¬ìš© ë¶ˆê°€            .path(\"/\") // ëª¨ë“  ê²½ë¡œì—ì„œ ìœ íš¨            .build();        response.addHeader(\"Set-Cookie\", cookie.toString());        return \"CSRF Token Issued\";    }    private String generateSecureToken() {        return java.util.UUID.randomUUID().toString();    }}\n\nì´ë ‡ê²Œí•˜ë©´ CSRF í† í°ì„ ë°›ì€ ì‚¬ìš©ìë„ CSRF í† í°ì´ ë¬´ì—‡ì¸ì§€ëŠ” ì•Œ ìˆ˜ ì—†ìœ¼ë‚˜.. ë°›ì€ ê·¸ëŒ€ë¡œ íƒ‘ì¬ë§Œí•´ì„œ APIìš”ì²­ì„ í•˜ë©´ ë˜ë‹ˆê¹Œ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤!ğŸ˜\n\n\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;2. SameSite ì¿ í‚¤ ì„¤ì • âœ…\nHttpOnlyì™€ Secure ì„¤ì •ì„ í–ˆë˜ ê²ƒì²˜ëŸ¼ ì¿ í‚¤ì— SameSite&#x3D;Strict ì˜µì…˜ì„ ì£¼ê²Œë˜ë©´, ë°©ê¸ˆê¹Œì§€ ì‚¬ìš©í•˜ë˜ ì›¹í˜ì´ì§€ê°€ ì•„ë‹Œ ë‹¤ë¥¸ URLì—ì„œ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•´ì„œ ìš”ì²­(Request)ì„ ë³´ë‚´ëŠ”ì§€ &#x3D; ë¬¸ìê·¸ëŒ€ë¡œ â€œSame Siteâ€ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ê³ , ê°™ì€ ê³³ì´ ì•„ë‹ ê²½ìš°, ì¸ì¦ì´ ëë‚œ ì‚¬ìš©ìì˜ ì¿ í‚¤ ì „ì†¡ì„ ìë™ìœ¼ë¡œ ë°©ì§€í•´ì¤ë‹ˆë‹¤.ğŸ‘®\n&nbsp;&nbsp; Set-Cookie: sessionid&#x3D;abc123; SameSite&#x3D;Strict\n\n\nSpringBoot ì„¤ì • ì˜ˆì‹œëŠ” CSRF í† í° ì˜ˆì‹œì— í•¨ê»˜ ì í˜€ìˆìœ¼ë‹ˆ ì°¸ê³  ë¶€íƒë“œë ¤ìš”.ğŸ˜š\n\n\n\n3. SSRF (Server-Side Request Forgery) ë°©ì§€\në§ˆì§€ë§‰ìœ¼ë¡œ SSRF ë°©ì§€ ë°©ë²• 2ê°€ì§€ë§Œ ê°„ë‹¨í•˜ê²Œ ì•Œì•„ë³´ê³ , í¬ìŠ¤íŒ…ì„ ë§ˆì¹˜ë„ë¡ í• ê²Œìš”! Part. 2ì—ì„œë„ ì–¸ê¸‰í–ˆì—ˆë˜, ì™¸ë¶€ë„ë©”ì¸ë§Œ í—ˆìš©í•˜ê²Œ í•˜ëŠ” ë°©ë²•ê³¼, Allowlist ë°©ì‹ì„ ì ìš©í•´ì„œ í—ˆìš©ëœ ë„ë©”ì¸ë§Œ APIë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ì„¸íŒ…í•˜ëŠ” ë°©ë²•ì´ì—ìš” :)\n\n&nbsp;&nbsp;&nbsp;&nbsp;1.  ë‚´ë¶€ IP ìš”ì²­ ì°¨ë‹¨ âœ‹\nì•„ë˜ì™€ ê°™ì´ ë‚´ë¶€ë§ ë„¤íŠ¸ì›Œí¬ì¼ ë•Œ ì‹œì‘ë˜ëŠ” 127, 172, 192ë¡œ IPê°€ ì‹œì‘í•˜ê³  ìˆì§€ëŠ” ì•ŠëŠ”ì§€ ì²´í¬í•´ì„œ ì™¸ë¶€ë„ë©”ì¸ë§Œ í—ˆìš©í•˜ëŠ” JS ì˜ˆì‹œì½”ë“œì…ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì€ ë¡œì§ìœ¼ë¡œ ê° ì„œë²„ ì–¸ì–´ì™€ ë¬¸ë²•ì— ë§ê²Œ ì‘ì„±í•˜ì‹œë©´ ë˜ê² ì£ ?ğŸ˜‡  node.jsjavascriptconst isInternalIP = (url) =&gt; {    return /^(127\\.0\\.0\\.1|192\\.168\\.|10\\.)/.test(url);};app.get('/fetch', (req, res) =&gt; {    const url = req.query.url;    if (isInternalIP(url)) {        return res.status(403).send('ë‚´ë¶€ë§ ìš”ì²­ ì°¨ë‹¨ë¨');    }    fetch(url).then(response =&gt; res.send(response.data));});\n\n&nbsp;&nbsp;&nbsp;&nbsp;2. Allowlist ë°©ì‹ ì ìš© âœ…\nì•„ë˜ì™€ ì˜ˆì‹œ ì½”ë“œì˜ ë¡œì§ê³¼ ê°™ì´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” íŠ¹ì • ë„ë©”ì¸ë§Œ ìš”ì²­í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•˜ê³  ìˆìŠµë‹ˆë‹¤.   node.jsjavascriptconst ALLOWED_DOMAINS = ['https://trusted.com', 'https://api.safe.com'];app.get('/fetch', (req, res) =&gt; {  const url = req.query.url;  if (!ALLOWED_DOMAINS.some(domain =&gt; url.startsWith(domain))) {    return res.status(403).send('í—ˆìš©ë˜ì§€ ì•Šì€ ë„ë©”ì¸');  }  fetch(url).then(response =&gt; res.send(response.data));});\n\n\n* ì, ê·¸ëŸ¼ ì—¬ê¸°ê¹Œì§€í•´ì„œ.. Web Auth & Security ì‹œë¦¬ì¦ˆì˜ ë§‰ì„ ë‚´ë ¤ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.ğŸª \n\n&nbsp;&nbsp;&nbsp;&nbsp; ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!ğŸ™‡ğŸ»â€â™‚ï¸\n\nReferences\n&nbsp;&nbsp; yiwoojung&#39;s velog, SCBê°œë°œìì´ì•¼ê¸°\n\n","dateCreated":"2025-02-15T22:52:43+09:00","dateModified":"2025-02-19T20:54:46+09:00","datePublished":"2025-02-15T22:52:43+09:00","description":"\n\nì›¹ ë³´ì•ˆì·¨ì•½ì  ë³´ì™„í•˜ê¸° ğŸ”\nPart.1 + Part.2 &#x3D; Part. 3 ğŸ’«\n","headline":"Web Auth & Security ğŸ‘®â€â™‚ï¸ Part. 3","image":["cover.webp","cover.webp"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://petercha90.github.io/2025/02/15/authentication-3/"},"publisher":{"@type":"Organization","name":"Peter Cha","sameAs":[],"image":"peter.webp","logo":{"@type":"ImageObject","url":"peter.webp"}},"url":"https://petercha90.github.io/2025/02/15/authentication-3/","keywords":"tutorial, XSS, CSRF, SSRF, authentication, token, session, cookies","thumbnailUrl":"cover.webp"}</script>
    <meta name="description" content="ì›¹ ë³´ì•ˆì·¨ì•½ì  ë³´ì™„í•˜ê¸° ğŸ” Part.1 + Part.2 &#x3D; Part. 3 ğŸ’«">
<meta property="og:type" content="blog">
<meta property="og:title" content="Web Auth &amp; Security ğŸ‘®â€â™‚ï¸ Part. 3">
<meta property="og:url" content="https://petercha90.github.io/2025/02/15/authentication-3/index.html">
<meta property="og:site_name" content="Peter&#39;s Place">
<meta property="og:description" content="ì›¹ ë³´ì•ˆì·¨ì•½ì  ë³´ì™„í•˜ê¸° ğŸ” Part.1 + Part.2 &#x3D; Part. 3 ğŸ’«">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-02-15T13:52:43.000Z">
<meta property="article:modified_time" content="2025-02-19T11:54:46.399Z">
<meta property="article:author" content="Peter Cha">
<meta property="article:tag" content="tutorial">
<meta property="article:tag" content="XSS">
<meta property="article:tag" content="CSRF">
<meta property="article:tag" content="SSRF">
<meta property="article:tag" content="authentication">
<meta property="article:tag" content="token">
<meta property="article:tag" content="session">
<meta property="article:tag" content="cookies">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://petercha90.github.io/assets/images/peter.webp"/>
    
    
        <meta property="og:image" content="https://petercha90.github.io/2025/02/15/authentication-3/cover.webp"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://petercha90.github.io/2025/02/15/authentication-3/cover.webp"/>
    
    
        <meta property="og:image" content="https://petercha90.github.io/2025/02/15/authentication-3/cover.webp"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://petercha90.github.io/2025/02/15/authentication-3/cover.webp"/>
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-yn9su5rny89orahfymzfa2u8byhysd8o72yfaznhspafvar2rewhkawm6lky.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DFMCMD9E8V"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-DFMCMD9E8V');
    </script>


    

    
        
    
<style>
    figure.codeblock {
       margin: 0;
    }
    figure figcaption .tabs {
      display: flex;
      margin: 0;
    }
    figure figcaption .tabs .tab {
      cursor: pointer;
      list-style: none;
      padding: 5px 15px;
    }
    figure figcaption .tabs .tab.active {
      background: #2d2d2d;
      color: white;
    }
  </style></head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Peter&#39;s Place
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/peter.webp" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/peter.webp" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Peter Cha</h4>
                <!-- 
                    <h5 class="sidebar-profile-bio"><p>author.bio</p>
</h5>
                 -->
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Search tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/visitors-book"
                            
                            rel="noopener"
                            title="Visitors&#39; book"
                        >
                        <i class="sidebar-button-icon fa fa-book" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Visitors&#39; book</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/petercha90/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-center
                    post-header-cover--partial"
             style="background-image:url('/2025/02/15/authentication-3/cover.webp');"
             data-behavior="4">
            
        </div>

            <div style="background: rgba(255,255,255,0.94);" id="main" data-behavior="4"
                 class="hasCover
                        hasCoverMetaOut
                        hasCoverCaption">
                
<article class="post">
    
        <span class="post-header-cover-caption caption">ì›¹ ë³´ì•ˆì·¨ì•½ì  ë³´ì™„í•˜ê¸°</span>
    
    
        <div class="post-header main-content-wrap text-center">
    
        <h1 class="post-title">
            Web Auth &amp; Security ğŸ‘®â€â™‚ï¸ Part. 3
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2025-02-15T22:52:43+09:00">
	
		    Feb 15, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/tutorial/">tutorial</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <!-- excerpt -->

<br>

<ul>
<li>ì•ˆë…•í•˜ì„¸ìš”, PETERì…ë‹ˆë‹¤.ğŸ‘‹ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” <a href="https://petercha90.github.io/2025/02/01/authentication_/">Part. 1</a>ê³¼ <a href="https://petercha90.github.io/2025/02/13/authentication-2/">Part. 2</a> ë‚´ìš©ì„ ëª¨ë‘ ì´í•´í•˜ê³  ìˆë‹¤ëŠ” ì „ì œ í•˜ì—, ì›¹ ì·¨ì•½ì ë“¤ì„ ì¿ í‚¤ ì„¸ì…˜ í† í°ì„ ê°€ì§€ê³  ì–´ë–»ê²Œ ì¡°ì¹˜í•  ìˆ˜ ìˆëŠ”ì§€. Part. 2ì—ì„œ ë‚˜ëˆ„ì§€ ëª»í–ˆë˜ ë°©ë²•ë“¤ì„ ë” ì•Œì•„ë³´ê¸°ë¡œ í•˜ê² ìŠµë‹ˆë‹¤.ğŸ¤—</li>
</ul>
<hr>

<h2 id="1-XSS-Cross-Site-Scripting-ë°©ì§€"><a href="#1-XSS-Cross-Site-Scripting-ë°©ì§€" class="headerlink" title="1. XSS (Cross-Site Scripting) ë°©ì§€"></a>1. XSS (Cross-Site Scripting) ë°©ì§€</h2><h4 id="nbsp-nbsp-ğŸ¥ -ì¿ í‚¤-ê´€ë ¨-ë³´ì•ˆ-ì„¤ì •"><a href="#nbsp-nbsp-ğŸ¥ -ì¿ í‚¤-ê´€ë ¨-ë³´ì•ˆ-ì„¤ì •" class="headerlink" title="&nbsp;&nbsp; ğŸ¥  ì¿ í‚¤ ê´€ë ¨ ë³´ì•ˆ ì„¤ì •"></a>&nbsp;&nbsp; ğŸ¥  ì¿ í‚¤ ê´€ë ¨ ë³´ì•ˆ ì„¤ì •</h4><ul>
<li><p><a href="https://petercha90.github.io/2025/02/01/authentication_/">Part. 1</a>ì—ì„œ Cookieë¥¼ ì„¤ëª…í•˜ë©´ì„œ, ê°œë°œìë„êµ¬ - Consoleì°½ì—ì„œ <code>document.cookie</code>ë¼ëŠ” JavaScriptë¥¼ ì…ë ¥í•˜ë©´ ë°”ë¡œ ë¸Œë¼ìš°ì €ì— ì €ì¥ëœ Cookieë“¤ì´ ëª¨ë‘ ì¶œë ¥ì´ ëœë‹¤ëŠ” ì‚¬ì‹¤! ê¸°ì–µë‚˜ì‹œë‚˜ìš”?!</p>
</li>
<li><p>ì´ ë§ì¸ì¦‰ìŠ¨, XSS ì·¨ì•½ì ì´ ìˆëŠ” ê²½ìš°, JavaScriptë¥¼ ì‚¬ìš©í•´ì„œ ì¿ í‚¤ ì •ë³´ë¥¼ í•´ì»¤ê°€ íƒˆì·¨í•  ìˆ˜ ìˆë‹¤ëŠ” ë§ì´ ë©ë‹ˆë‹¤!ğŸ™€ í•˜ì§€ë§Œ XSS ì·¨ì•½ì ì´ ìˆëŠ” ìƒí™©ì—ë„ ì¿ í‚¤ì— JavaScriptë¥¼ ì‚¬ìš©í•´ì„œ ì¿ í‚¤ ë‚´ìš©ì— ì ‘ê·¼í•  ìˆ˜ ì—†ê²Œí•˜ëŠ” ë°©ë²•ì´ ìˆìœ¼ë‹ˆ, ë°”ë¡œ <code>HttpOnly</code>ì™€, <code>Secure</code> ì„¤ì • ë˜ì‹œê² ìŠµë‹ˆë‹¤.ğŸ˜</p>
</li>
</ul>
<h4 id="nbsp-nbsp-nbsp-nbsp-1-HttpOnly-ğŸ¤«"><a href="#nbsp-nbsp-nbsp-nbsp-1-HttpOnly-ğŸ¤«" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;1. HttpOnly ğŸ¤«"></a>&nbsp;&nbsp;&nbsp;&nbsp;1. HttpOnly ğŸ¤«</h4><ul>
<li><p>ì•„ë˜ì™€ ê°™ì´ Cookieë¥¼ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ë³´ë‚´ì¤„ ë•Œ, HttpOnly ì„¤ì •ì„ í•´ì£¼ë©´ ì‹¤ì œë¡œëŠ” í•´ë‹¹ ì¿ í‚¤ê°€ ë¸Œë¼ìš°ì €ì— ì €ì¥ì´ ì˜ ëì§€ë§Œ, í´ë¼ì´ì–¸íŠ¸ì¸ ë¸Œë¼ìš°ì € ë‹¨ì—ì„œëŠ” <code>console.log(document.cookie)</code> ë“±ê³¼ ê°™ì´ JavaScriptë¡œ ì¶œë ¥í•´ë„ ì•„ë¬´ê²ƒë„ ì¶œë ¥ë˜ì§€ ì•Šì•„ ì¿ í‚¤ ë‚´ìš©ì„ ì•Œ ìˆ˜ ì—†ê²Œ ë©ë‹ˆë‹¤! ğŸ‘</p>
<blockquote>
<p>&nbsp;&nbsp;Set-Cookie: sessionid&#x3D;abc123; <strong>HttpOnly</strong></p>
</blockquote>
</li>
</ul>
<h4 id="nbsp-nbsp-nbsp-nbsp-2-Secure-ğŸ‘®"><a href="#nbsp-nbsp-nbsp-nbsp-2-Secure-ğŸ‘®" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;2. Secure ğŸ‘®"></a>&nbsp;&nbsp;&nbsp;&nbsp;2. Secure ğŸ‘®</h4><ul>
<li><p>Secure ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´, Httpsë¡œ ì¸ì¦ëœ ì‚¬ì´íŠ¸ì—ì„œë§Œ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ(&#x3D;ë¸Œë¼ìš°ì €ì—ì„œ ì„œë²„ë¡œ ì „ì†¡í•  ìˆ˜ ìˆê²Œ)í•´ì¤˜ì„œ, ë³´ì•ˆì´ ì·¨ì•½í•œ HTTP ì‚¬ì´íŠ¸ì—ì„œëŠ” ì¿ í‚¤ê°€ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•´ì£¼ë©´ í•´ì»¤ê°€ íƒˆì·¨í•œë‹¤í•œë“¤ ì‚¬ìš©í•  ìˆ˜ ì—†ê² ì£ ? ğŸ˜¼</p>
<blockquote>
<p>&nbsp;&nbsp;Set-Cookie: sessionid&#x3D;abc123; <strong>Secure</strong></p>
</blockquote>
</li>
</ul>
<h6 id="nbsp-nbsp-nbsp-nbsp-SpringBoot-example-âœï¸"><a href="#nbsp-nbsp-nbsp-nbsp-SpringBoot-example-âœï¸" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example âœï¸"></a>&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example âœï¸</h6><ul>
<li>ê·¸ë ‡ë‹¤ë©´ HttpOnly, Secure ì˜µì…˜ë“¤ì€ ì–´ë””ì„œ ì„¤ì •í•´ì•¼ í• ê¹Œìš”? ì •ë³´ë¥¼ ë‹´ì•„ì„œ ë³´ë‚´ì£¼ëŠ” ì„œë²„ê°€ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤! ì•„ë˜ëŠ” ë‘ ì˜µì…˜ì„ ì ìš©í•˜ëŠ” ë‘ ê°€ì§€ SpringBoot ì˜ˆì‹œì—ìš”. ë§ˆì°¬ê°€ì§€ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ì„œë²„ê°€ Djangoë“ , node.jsë“  í•´ë‹¹ ì„œë²„ì˜ ë°©ì‹ëŒ€ë¡œ ì•„ë˜ì™€ ê°™ì´ ì¿ í‚¤ì— ì„¤ì •ì„ í•´ì¤˜ì„œ ë³´ë‚´ì£¼ë©´ ë˜ê² ì£ ?<ul>
<li>Spring Securityë¥¼ ì‚¬ìš©í•˜ë©´ ìë™ìœ¼ë¡œ JSESSIONID ì¿ í‚¤ì— HttpOnly ì†ì„±ì´ ì ìš©ëœë‹¤ê³ í•˜ë‹ˆ, ì°¸ê³ í•˜ì„¸ìš”!ğŸ˜‰</li>
</ul>
  <figure class="codeblock codeblock--tabbed"><figcaption><span>springboot</span><ul class="tabs"><li class="tab active">java</li></ul></figcaption><div class="tabs-content"><figure class="highlight java" style="display: block;"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CookieController</span> {</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping("/set-cookie")</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">setCookie</span><span class="params">(HttpServletResponse response)</span> {</span><br><span class="line">        <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">"sessionID"</span>, <span class="string">"123456"</span>); <span class="comment">// ì¿ í‚¤ ì´ë¦„ê³¼ ê°’ ì„¤ì •</span></span><br><span class="line">        cookie.setHttpOnly(<span class="literal">true</span>); <span class="comment">// HttpOnly ì†ì„± ì„¤ì • (JavaScriptì—ì„œ ì ‘ê·¼ ë¶ˆê°€ëŠ¥)</span></span><br><span class="line">        cookie.setSecure(<span class="literal">true</span>); <span class="comment">// HTTPS í™˜ê²½ì—ì„œë§Œ ì¿ í‚¤ ì „ì†¡ (ë³´ì•ˆ ê°•í™”)</span></span><br><span class="line">        cookie.setPath(<span class="string">"/"</span>); <span class="comment">// ì¿ í‚¤ê°€ ì „ì²´ ë„ë©”ì¸ì—ì„œ ìœ íš¨í•˜ë„ë¡ ì„¤ì •</span></span><br><span class="line">        cookie.setMaxAge(<span class="number">60</span> * <span class="number">60</span>); <span class="comment">// ì¿ í‚¤ ìœ íš¨ ì‹œê°„: 1ì‹œê°„ (ì´ˆ ë‹¨ìœ„)</span></span><br><span class="line"></span><br><span class="line">        response.addCookie(cookie); <span class="comment">// ì‘ë‹µì— ì¿ í‚¤ ì¶”ê°€</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"HttpOnly ì¿ í‚¤ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!"</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// ìœ„ì— setCookieì™€ ì•„ë˜ setCookieWithHeaderëŠ” ë˜‘ê°™ì€ ê²°ê³¼. ë‘˜ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©</span></span><br><span class="line">    <span class="meta">@GetMapping("/set-cookie-header")</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">setCookieWithHeader</span><span class="params">(HttpServletResponse response)</span> {</span><br><span class="line">        response.setHeader(<span class="string">"Set-Cookie"</span>, </span><br><span class="line">            <span class="string">"sessionID=123456; HttpOnly; Secure; Path=/; Max-Age=3600"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"HttpOnly ì¿ í‚¤ê°€ ì‘ë‹µ í—¤ë”ì— ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div></figure></li>
</ul>
<h4 id="nbsp-nbsp-nbsp-nbsp-3-Content-Security-Policy-CSP-ì ìš©-ğŸ«°"><a href="#nbsp-nbsp-nbsp-nbsp-3-Content-Security-Policy-CSP-ì ìš©-ğŸ«°" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;3. Content Security Policy(CSP) ì ìš© ğŸ«°"></a>&nbsp;&nbsp;&nbsp;&nbsp;3. Content Security Policy(CSP) ì ìš© ğŸ«°</h4><ul>
<li><p>ì›¹ì‚¬ì´íŠ¸ì— ì•„ë˜ì˜ <code>&lt;meta&gt;</code> tagë¥¼ í•œ ì¤„ ë„£ì–´ì£¼ëŠ” ì£¼ëŠ” ê²ƒìœ¼ë¡œë„, ê¸°ë³¸ì ì¸ XSSë¥¼ ì˜ˆë°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.ğŸ«¡ ì½”ë“œì˜ ì„¸ë¶€ì ì¸ ì˜ë¯¸ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. </p>
  <figure class="codeblock codeblock--tabbed"><figcaption><span>csp</span><ul class="tabs"><li class="tab active">html</li></ul></figcaption><div class="tabs-content"><figure class="highlight html" style="display: block;"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Security-Policy"</span> <span class="attr">content</span>=<span class="string">"default-src 'self'; script-src 'self' https://apis.trusteddomain.com"</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></div></figure>
</li>
<li><p><code>http-equiv=&quot;Content-Security-Policy&quot;</code> </p>
<blockquote>
<p>ğŸ‘‰ ë¸Œë¼ìš°ì €ì—ê²Œ CSP ì •ì±…ì„ ì ìš©í•˜ë¼ê³  ì§€ì‹œí•¨.</p>
</blockquote>
<p> <code>content=&quot;...&quot;</code></p>
<blockquote>
<p>ğŸ‘‰ ì ìš©í•  CSP ì •ì±…ì„ ì •ì˜.</p>
</blockquote>
<p> <code>default-src &#39;self&#39;</code></p>
<blockquote>
<p>ğŸ‘‰ í˜„ì¬ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” ë¦¬ì†ŒìŠ¤(ìŠ¤í¬ë¦½íŠ¸, ì´ë¯¸ì§€, ìŠ¤íƒ€ì¼ ë“±)ë§Œ ë¡œë“œ ê°€ëŠ¥.<br>&nbsp;&nbsp; ì™¸ë¶€ ë„ë©”ì¸ì—ì„œ ë¡œë“œí•˜ëŠ” ë¦¬ì†ŒìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì°¨ë‹¨ë¨. </p>
</blockquote>
<p> <code>script-src &#39;self&#39; https://apis.trusteddomain.com</code></p>
<blockquote>
<p>ğŸ‘‰&nbsp;&nbsp;â€™selfâ€™ - í˜„ì¬ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë§Œ í—ˆìš©.<br>ğŸ‘‰&nbsp;&nbsp;<a target="_blank" rel="noopener" href="https://apis.trusteddomain.com/">https://apis.trusteddomain.com</a> - ì´ íŠ¹ì • ì™¸ë¶€ ë„ë©”ì¸ì—ì„œ ì œê³µí•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ëŠ” í—ˆìš©.     ë‹¤ë¥¸ ì™¸ë¶€ ë„ë©”ì¸ì˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì°¨ë‹¨ë¨.</p>
</blockquote>
</li>
<li><p>ë” ë§ì€ ì˜µì…˜ë“¤ì´ ìˆì§€ë§Œ, CSPëŠ” ì´ì •ë„ë§Œ ì•Œì•„ë³´ê¸°ë¡œ í•˜ê² ìŠµë‹ˆë‹¤!</p>
</li>
</ul>
<Br>

<h2 id="2-CSRF-Cross-Site-Request-Forgery-ë°©ì§€"><a href="#2-CSRF-Cross-Site-Request-Forgery-ë°©ì§€" class="headerlink" title="2. CSRF (Cross-Site Request Forgery) ë°©ì§€"></a>2. CSRF (Cross-Site Request Forgery) ë°©ì§€</h2><ul>
<li>ì, ì´ë²ˆì—” CSRF ê³µê²©ì„ ë°©ì§€í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì‚´í´ ë³´ê² ìŠµë‹ˆë‹¤. Part. 2ì—ì„œ CSRFë¥¼ ë°©ì–´í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì„¤ëª…ë“œë ¸ë˜ <code>Referer ì²´í¬í•˜ê¸°</code>ëŠ” CSRF ê³µê²©ì´ ì•„ë‹Œë°ë„ Refererê°€ ì‹¤ì œë¡œ ì—†ëŠ” ê²½ìš°ê°€ ìˆì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—. í•­ìƒ CSRF ê³µê²©ì¸ì§€ ì—¬ë¶€ë¥¼ ë°˜ë³„í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ì•„ë‹™ë‹ˆë‹¤.ğŸ™…</li>
<li>ì‚¬ìš©ìê°€ ì§ì ‘ URLì„ ì…ë ¥í•´ì„œ ìµœì´ˆ ì…ë ¥ì„ í•˜ëŠ” ê²½ìš°, ìµœì´ˆ ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í–ˆê¸° ë•Œë¬¸ì— Refererê°€ ì—†ì„ ìˆ˜ ìˆê³ , ê³ ê°ì˜ ê°œì¸ì •ë³´ì— ë¯¼ê°í•œ ì‚¬ì´íŠ¸ë“¤ì€ ê³ ê°ì˜ í–‰ë™ì„ ì¶”ì í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ë•Œë¬¸ì— Refererë¥¼ ë‚ ë ¤ë²„ë¦´ ìˆ˜ë„ ìˆì–´ìš”.ğŸ«¢ </li>
<li>ì´ëŸ° ê²½ìš°ê¹Œì§€ë„ ëª¨ë‘ Refererê°€ ì—†ë‹¤ê³  CSRF ê³µê²©ìœ¼ë¡œ ê°„ì£¼í•´ì„œëŠ” ì•ˆë˜ê² ì£ ? ê·¸ë˜ì„œ ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ë“¤ì„ ì‚¬ìš©í•´ì„œ CSRFë¥¼ ë°©ì–´í•©ë‹ˆë‹¤.</li>
</ul>
<hr>

<h4 id="nbsp-nbsp-nbsp-nbsp-1-CSRF-í† í°-ì‚¬ìš©-ğŸ«"><a href="#nbsp-nbsp-nbsp-nbsp-1-CSRF-í† í°-ì‚¬ìš©-ğŸ«" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;1. CSRF í† í° ì‚¬ìš© ğŸ«"></a>&nbsp;&nbsp;&nbsp;&nbsp;1. CSRF í† í° ì‚¬ìš© ğŸ«</h4><ul>
<li>ê°€ì¥ íš¨ê³¼ì ìœ¼ë¡œ CSRF ê³µê²©ì„ ë°©ì§€ í•˜ëŠ” ë°©ë²•ì€ <strong><span class="highlight-text" style="background-color:#FFDFB8;"><u>í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚´ëŠ” ëª¨ë“  ìš”ì²­ì— ì„œë²„ê°€ ìƒì„±í•œ CSRF í† í°ì„ í¬í•¨í•´ì•¼ë§Œ ì²˜ë¦¬ë˜ë„ë¡ ì„¤ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤!</u></span></strong></li>
<li>Tokenì€ ê¸°ë³¸ì ìœ¼ë¡œ ì•„ì£¼ ê¸´ ë¬¸ìì—´ì˜ í˜•íƒœë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³  í–ˆì—ˆì£ ! ì„œë²„ëŠ” ëœë¤&#x2F;ë³µì¡í•œ ê·œì¹™ìœ¼ë¡œ ì´ CSRF í† í°ì„ ìƒì„±í•˜ì—¬ ì•„ë˜ì˜ ìˆœì„œë¡œ CSRF í† í°ì„ ê²€ì¦í•©ë‹ˆë‹¤. <blockquote>
<ol>
<li>ìœ ì €ê°€ ë¡œê·¸ì¸í•  ë•Œ Sessionì •ë³´ì™€ í•¨ê»˜ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•˜ê³ ,</li>
<li>íŠ¹ì • APIê°€ ì‹¤í–‰ë  ë•Œ(e.g. ì†¡ê¸ˆí•˜ê¸°)ëŠ” ë°›ì•˜ë˜ CSRF í† í°ì„ í•­ìƒ í•¨ê»˜ ë„£ì–´ì¤ë‹ˆë‹¤.</li>
<li>ì„œë²„ê°€ Clientë¡œë¶€í„° ë°›ì€ CSRF í† í°ì„ ì„œë²„ì˜ í† í°ê³¼ ë¹„êµ&amp;ì¸ì¦ì´ ì„±ê³µí•˜ë©´ í•´ë‹¹ ìš”ì²­ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.</li>
</ol>
</blockquote>
</li>
</ul>
<h6 id="nbsp-nbsp-nbsp-nbsp-nbsp-ì–´-ê·¼ë°-ì ê¹ë§Œ"><a href="#nbsp-nbsp-nbsp-nbsp-nbsp-ì–´-ê·¼ë°-ì ê¹ë§Œ" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ì–´..? ê·¼ë° ì ê¹ë§Œ."></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ì–´..? ê·¼ë° ì ê¹ë§Œ.</h6><ul>
<li>ì, ê·¼ë° ë°”ë¡œ ì—¬ê¸°ì„œ..! ì—¬ê¸°ê¹Œì§€ ì˜ ë”°ë¼ì˜¤ì‹  ë¶„ë“¤ì´ë¼ë©´ ì´ëŸ° ì§ˆë¬¸ì´ ë“œì‹¤ ìˆ˜ë„ ìˆìœ¼ì‹¤ê±°ì—ìš”. <blockquote>
<p>&nbsp;&nbsp; ???: â€œì•„ë‹ˆ.. ê·¼ë° ê·¸ CSRF í† í°ë„ XSS ê³µê²©ìœ¼ë¡œ í„¸ë¦¬ë©´(?).. í•´ì»¤ê°€ CSRF í† í°ë„ ì‚¬ìš©í•˜ê³  ìœ ì € ì¿ í‚¤ë„ ì‚¬ìš©í•´ì„œ CSRF ë°©ì–´ê°€ ì•ˆë˜ëŠ” ê±° ì•„ë‹Œê°€..??â€ğŸ¤”</p>
</blockquote>
</li>
<li>ê·¸ë ‡ìŠµë‹ˆë‹¤.. ê·¸ë ‡ê¸° ë•Œë¬¸ì— <u><strong><span class="highlight-text" style="background-color:#cae9ea;">CSRF í† í°ì„ ì„œë²„ê°€ ë¸Œë¼ìš°ì €(=Front-end)ë¡œ ì „ë‹¬í•  ë•Œì—ëŠ” ê¼­, HttpOnly + Secure ì¿ í‚¤ë¡œ ê¼­ ì „ë‹¬í•´ì•¼í•©ë‹ˆë‹¤!!</span></strong></u> JavaScriptë¡œ íƒˆì·¨í•˜ë”ë¼ë„ í† í° ë‚´ìš©ì´ ë¬´ì—‡ì¸ì§€ ì•Œ ìˆ˜ ì—†ë„ë¡ ë§ì´ì£ ! (ìœ„ì—ì„œ ë¨¼ì € ì„¤ëª…í•œ ì´ìœ ..í›„í›„..ğŸ˜)</li>
</ul>
<h6 id="nbsp-nbsp-nbsp-nbsp-SpringBoot-example-âœï¸-1"><a href="#nbsp-nbsp-nbsp-nbsp-SpringBoot-example-âœï¸-1" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example âœï¸"></a>&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example âœï¸</h6><ul>
<li><p>SpringBootì—ì„œ CSRF í† í°ì„ ì•ˆì „í•˜ê²Œ ì¿ í‚¤ë¡œ ì „ë‹¬í•˜ëŠ” ì˜ˆì‹œì½”ë“œì…ë‹ˆë‹¤. :)</p>
  <figure class="codeblock codeblock--tabbed"><figcaption><span>springboot</span><ul class="tabs"><li class="tab active">java</li></ul></figcaption><div class="tabs-content"><figure class="highlight java" style="display: block;"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.http.ResponseCookie;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CsrfController</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping("/api/csrf-token")</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCsrfToken</span><span class="params">(HttpServletResponse response)</span> {</span><br><span class="line">        <span class="type">String</span> <span class="variable">csrfToken</span> <span class="operator">=</span> generateSecureToken(); <span class="comment">// CSRF í† í° ìƒì„±</span></span><br><span class="line"></span><br><span class="line">        <span class="type">ResponseCookie</span> <span class="variable">cookie</span> <span class="operator">=</span> ResponseCookie.from(<span class="string">"XSRF-TOKEN"</span>, csrfToken)</span><br><span class="line">            .httpOnly(<span class="literal">true</span>)  <span class="comment">// JavaScriptì—ì„œ ì ‘ê·¼ ë¶ˆê°€</span></span><br><span class="line">            .secure(<span class="literal">true</span>)    <span class="comment">// HTTPSì—ì„œë§Œ ì „ì†¡</span></span><br><span class="line">            .sameSite(<span class="string">"Strict"</span>) <span class="comment">// ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œëŠ” ì‚¬ìš© ë¶ˆê°€</span></span><br><span class="line">            .path(<span class="string">"/"</span>) <span class="comment">// ëª¨ë“  ê²½ë¡œì—ì„œ ìœ íš¨</span></span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">        response.addHeader(<span class="string">"Set-Cookie"</span>, cookie.toString());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"CSRF Token Issued"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">generateSecureToken</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> java.util.UUID.randomUUID().toString();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div></figure>
</li>
<li><p>ì´ë ‡ê²Œí•˜ë©´ CSRF í† í°ì„ ë°›ì€ ì‚¬ìš©ìë„ CSRF í† í°ì´ ë¬´ì—‡ì¸ì§€ëŠ” ì•Œ ìˆ˜ ì—†ìœ¼ë‚˜.. ë°›ì€ ê·¸ëŒ€ë¡œ íƒ‘ì¬ë§Œí•´ì„œ APIìš”ì²­ì„ í•˜ë©´ ë˜ë‹ˆê¹Œ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤!ğŸ˜</p>
</li>
</ul>
<br>

<h4 id="nbsp-nbsp-nbsp-nbsp-2-SameSite-ì¿ í‚¤-ì„¤ì •-âœ…"><a href="#nbsp-nbsp-nbsp-nbsp-2-SameSite-ì¿ í‚¤-ì„¤ì •-âœ…" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;2. SameSite ì¿ í‚¤ ì„¤ì • âœ…"></a>&nbsp;&nbsp;&nbsp;&nbsp;2. SameSite ì¿ í‚¤ ì„¤ì • âœ…</h4><ul>
<li>HttpOnlyì™€ Secure ì„¤ì •ì„ í–ˆë˜ ê²ƒì²˜ëŸ¼ ì¿ í‚¤ì— SameSite&#x3D;Strict ì˜µì…˜ì„ ì£¼ê²Œë˜ë©´, ë°©ê¸ˆê¹Œì§€ ì‚¬ìš©í•˜ë˜ ì›¹í˜ì´ì§€ê°€ ì•„ë‹Œ ë‹¤ë¥¸ URLì—ì„œ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•´ì„œ ìš”ì²­(Request)ì„ ë³´ë‚´ëŠ”ì§€ &#x3D; ë¬¸ìê·¸ëŒ€ë¡œ â€œSame Siteâ€ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ê³ , ê°™ì€ ê³³ì´ ì•„ë‹ ê²½ìš°, ì¸ì¦ì´ ëë‚œ ì‚¬ìš©ìì˜ ì¿ í‚¤ ì „ì†¡ì„ ìë™ìœ¼ë¡œ ë°©ì§€í•´ì¤ë‹ˆë‹¤.ğŸ‘®<blockquote>
<p>&nbsp;&nbsp; Set-Cookie: sessionid&#x3D;abc123; <strong>SameSite&#x3D;Strict</strong></p>
</blockquote>
</li>
<li>SpringBoot ì„¤ì • ì˜ˆì‹œëŠ” CSRF í† í° ì˜ˆì‹œì— í•¨ê»˜ ì í˜€ìˆìœ¼ë‹ˆ ì°¸ê³  ë¶€íƒë“œë ¤ìš”.ğŸ˜š</li>
</ul>
<br>

<h2 id="3-SSRF-Server-Side-Request-Forgery-ë°©ì§€"><a href="#3-SSRF-Server-Side-Request-Forgery-ë°©ì§€" class="headerlink" title="3. SSRF (Server-Side Request Forgery) ë°©ì§€"></a>3. SSRF (Server-Side Request Forgery) ë°©ì§€</h2><ul>
<li>ë§ˆì§€ë§‰ìœ¼ë¡œ SSRF ë°©ì§€ ë°©ë²• 2ê°€ì§€ë§Œ ê°„ë‹¨í•˜ê²Œ ì•Œì•„ë³´ê³ , í¬ìŠ¤íŒ…ì„ ë§ˆì¹˜ë„ë¡ í• ê²Œìš”! Part. 2ì—ì„œë„ ì–¸ê¸‰í–ˆì—ˆë˜, ì™¸ë¶€ë„ë©”ì¸ë§Œ í—ˆìš©í•˜ê²Œ í•˜ëŠ” ë°©ë²•ê³¼, Allowlist ë°©ì‹ì„ ì ìš©í•´ì„œ í—ˆìš©ëœ ë„ë©”ì¸ë§Œ APIë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ì„¸íŒ…í•˜ëŠ” ë°©ë²•ì´ì—ìš” :)</li>
</ul>
<h4 id="nbsp-nbsp-nbsp-nbsp-1-ë‚´ë¶€-IP-ìš”ì²­-ì°¨ë‹¨-âœ‹"><a href="#nbsp-nbsp-nbsp-nbsp-1-ë‚´ë¶€-IP-ìš”ì²­-ì°¨ë‹¨-âœ‹" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;1.  ë‚´ë¶€ IP ìš”ì²­ ì°¨ë‹¨ âœ‹"></a>&nbsp;&nbsp;&nbsp;&nbsp;1.  ë‚´ë¶€ IP ìš”ì²­ ì°¨ë‹¨ âœ‹</h4><ul>
<li>ì•„ë˜ì™€ ê°™ì´ ë‚´ë¶€ë§ ë„¤íŠ¸ì›Œí¬ì¼ ë•Œ ì‹œì‘ë˜ëŠ” 127, 172, 192ë¡œ IPê°€ ì‹œì‘í•˜ê³  ìˆì§€ëŠ” ì•ŠëŠ”ì§€ ì²´í¬í•´ì„œ ì™¸ë¶€ë„ë©”ì¸ë§Œ í—ˆìš©í•˜ëŠ” JS ì˜ˆì‹œì½”ë“œì…ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì€ ë¡œì§ìœ¼ë¡œ ê° ì„œë²„ ì–¸ì–´ì™€ ë¬¸ë²•ì— ë§ê²Œ ì‘ì„±í•˜ì‹œë©´ ë˜ê² ì£ ?ğŸ˜‡  <figure class="codeblock codeblock--tabbed"><figcaption><span>node.js</span><ul class="tabs"><li class="tab active">javascript</li></ul></figcaption><div class="tabs-content"><figure class="highlight javascript" style="display: block;"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">isInternalIP</span> = (<span class="params">url</span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^(127\.0\.0\.1|192\.168\.|10\.)/</span>.<span class="title function_">test</span>(url);</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">'/fetch'</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> url = req.<span class="property">query</span>.<span class="property">url</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isInternalIP</span>(url)) {</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(<span class="string">'ë‚´ë¶€ë§ ìš”ì²­ ì°¨ë‹¨ë¨'</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="title function_">fetch</span>(url).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> res.<span class="title function_">send</span>(response.<span class="property">data</span>));</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure></div></figure></li>
</ul>
<h4 id="nbsp-nbsp-nbsp-nbsp-2-Allowlist-ë°©ì‹-ì ìš©-âœ…"><a href="#nbsp-nbsp-nbsp-nbsp-2-Allowlist-ë°©ì‹-ì ìš©-âœ…" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;2. Allowlist ë°©ì‹ ì ìš© âœ…"></a>&nbsp;&nbsp;&nbsp;&nbsp;2. Allowlist ë°©ì‹ ì ìš© âœ…</h4><ul>
<li>ì•„ë˜ì™€ ì˜ˆì‹œ ì½”ë“œì˜ ë¡œì§ê³¼ ê°™ì´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” íŠ¹ì • ë„ë©”ì¸ë§Œ ìš”ì²­í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•˜ê³  ìˆìŠµë‹ˆë‹¤.   <figure class="codeblock codeblock--tabbed"><figcaption><span>node.js</span><ul class="tabs"><li class="tab active">javascript</li></ul></figcaption><div class="tabs-content"><figure class="highlight javascript" style="display: block;"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">ALLOWED_DOMAINS</span> = [<span class="string">'https://trusted.com'</span>, <span class="string">'https://api.safe.com'</span>];</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">'/fetch'</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> {</span><br><span class="line">  <span class="keyword">const</span> url = req.<span class="property">query</span>.<span class="property">url</span>;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable constant_">ALLOWED_DOMAINS</span>.<span class="title function_">some</span>(<span class="function"><span class="params">domain</span> =&gt;</span> url.<span class="title function_">startsWith</span>(domain))) {</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(<span class="string">'í—ˆìš©ë˜ì§€ ì•Šì€ ë„ë©”ì¸'</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="title function_">fetch</span>(url).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> res.<span class="title function_">send</span>(response.<span class="property">data</span>));</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure></div></figure></li>
</ul>
<hr>
* ì, ê·¸ëŸ¼ ì—¬ê¸°ê¹Œì§€í•´ì„œ.. Web Auth & Security ì‹œë¦¬ì¦ˆì˜ ë§‰ì„ ë‚´ë ¤ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.ğŸª 

<h6 id="nbsp-nbsp-nbsp-nbsp-ì½ì–´ì£¼ì…”ì„œ-ê°ì‚¬í•©ë‹ˆë‹¤-ğŸ™‡ğŸ»â€â™‚ï¸"><a href="#nbsp-nbsp-nbsp-nbsp-ì½ì–´ì£¼ì…”ì„œ-ê°ì‚¬í•©ë‹ˆë‹¤-ğŸ™‡ğŸ»â€â™‚ï¸" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp; ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!ğŸ™‡ğŸ»â€â™‚ï¸"></a>&nbsp;&nbsp;&nbsp;&nbsp; ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!ğŸ™‡ğŸ»â€â™‚ï¸</h6><br>

<h5 id="References"><a href="#References" class="headerlink" title="References"></a>References</h5><blockquote>
<p>&nbsp;&nbsp; <a target="_blank" rel="noopener" href="https://velog.io/@eeeve/HttpOnly%EC%99%80-Secure-Cookie"><code>yiwoojung&#39;s velog</code></a>, <a target="_blank" rel="noopener" href="https://devscb.tistory.com/123"><code>SCBê°œë°œìì´ì•¼ê¸°</code></a></p>
</blockquote>
<br>
            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        <center><a target="_blank" rel="noopener" href="https://www.buymeacoffee.com/petercha"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=petercha&button_colour=FFDD00&font_colour=000000&font_family=Bree&outline_colour=000000&coffee_colour=ffffff" /></a></center>
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/CSRF/" rel="tag">CSRF</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/SSRF/" rel="tag">SSRF</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/XSS/" rel="tag">XSS</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/authentication/" rel="tag">authentication</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/cookies/" rel="tag">cookies</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/session/" rel="tag">session</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/token/" rel="tag">token</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/tutorial/" rel="tag">tutorial</a>

            </div>
        
        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Peter Cha. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/peter.webp" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Peter Cha</h4>
        
            <div style="margin-top: -5%" id="about-card-bio"> A normal developer.
        
        
                <br> <br>
                ğŸ“­ &nbsp;
                 petercha90@gmail.com
                <br/>
            </div>
            
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.webp');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-oucp2gddrcsezh9z9ulhreq7falixqmvy4hwsvswurwz0zjkzlygrbowakam.min.js"></script>

<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'https://petercha90.github.io/2025/02/15/authentication-3/';
              
            this.page.identifier = '2025/02/15/authentication-3/';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'petercha90';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    <script>
  $(document).ready(function() {
    $('figure.codeblock').find('.tab').click(function() {
        var $codeblock = $(this).parent().parent().parent();
        var $tab = $(this);
        // remove "active" css class on all tabs
        $tab.siblings().removeClass('active');
        // add "active" css class on the clicked tab
        $tab.addClass('active');
        // hide all tab contents
        $codeblock.find('.highlight').hide();
        // show only the right one
        $codeblock.find('.highlight.' + $tab.text()).show();
    });
  });
  </script></body>
</html>
