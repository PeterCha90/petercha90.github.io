
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Peter&#39;s Place">
    <title>Web Auth &amp; Security 👮‍♂️ Part. 3 - Peter&#39;s Place</title>
    <meta name="author" content="Peter Cha">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4926107872672843"
     crossorigin="anonymous"></script>
    
        <meta name="keywords" content="tutorial,authentication,token,session,cookies,XSS,CSRF,SSRF">
    
    
        <link rel="icon" href="https://petercha90.github.io/assets/images/pp.webp">
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Peter Cha","sameAs":[],"image":"peter.webp"},"articleBody":"\n\n\n\n\n안녕하세요, PETER입니다.👋 이번 포스팅에서는 Part. 1과 Part. 2 내용을 모두 이해하고 있다는 전제 하에, 웹 취약점들을 쿠키 세션 토큰을 가지고 어떻게 조치할 수 있는지. Part. 2에서 나누지 못했던 방법들을 더 알아보기로 하겠습니다.🤗\n\n\n\n1. XSS (Cross-Site Scripting) 방지&nbsp;&nbsp; 🥠 쿠키 관련 보안 설정\nPart. 1에서 Cookie를 설명하면서, 개발자도구 - Console창에서 document.cookie라는 JavaScript를 입력하면 바로 브라우저에 저장된 Cookie들이 모두 출력이 된다는 사실! 기억나시나요?!\n\n이 말인즉슨, XSS 취약점이 있는 경우, JavaScript를 사용해서 쿠키 정보를 해커가 탈취할 수 있다는 말이 됩니다!🙀 하지만 XSS 취약점이 있는 상황에도 쿠키에 JavaScript를 사용해서 쿠키 내용에 접근할 수 없게하는 방법이 있으니, 바로 HttpOnly와, Secure 설정 되시겠습니다.😎\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;1. HttpOnly 🤫\n아래와 같이 Cookie를 서버에서 클라이언트로 보내줄 때, HttpOnly 설정을 해주면 실제로는 해당 쿠키가 브라우저에 저장이 잘 됐지만, 클라이언트인 브라우저 단에서는 console.log(document.cookie) 등과 같이 JavaScript로 출력해도 아무것도 출력되지 않아 쿠키 내용을 알 수 없게 됩니다! 👍\n\n&nbsp;&nbsp;Set-Cookie: sessionid&#x3D;abc123; HttpOnly\n\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;2. Secure 👮\nSecure 옵션을 사용하면, Https로 인증된 사이트에서만 쿠키를 사용할 수 있게(&#x3D;브라우저에서 서버로 전송할 수 있게)해줘서, 보안이 취약한 HTTP 사이트에서는 쿠키가 전송되지 않습니다. 이렇게 해주면 해커가 탈취한다한들 사용할 수 없겠죠? 😼\n\n&nbsp;&nbsp;Set-Cookie: sessionid&#x3D;abc123; Secure\n\n\n\n&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example ✍️\n그렇다면 HttpOnly, Secure 옵션들은 어디서 설정해야 할까요? 정보를 담아서 보내주는 서버가 해줘야 합니다! 아래는 두 옵션을 적용하는 두 가지 SpringBoot 예시에요. 마찬가지로 서비스를 제공하는 서버가 Django든, node.js든 해당 서버의 방식대로 아래와 같이 쿠키에 설정을 해줘서 보내주면 되겠죠?\nSpring Security를 사용하면 자동으로 JSESSIONID 쿠키에 HttpOnly 속성이 적용된다고하니, 참고하세요!😉\n\n  springbootjavaimport jakarta.servlet.http.Cookie;import jakarta.servlet.http.HttpServletResponse;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RestController;@RestControllerpublic class CookieController {    @GetMapping(\"/set-cookie\")    public String setCookie(HttpServletResponse response) {        Cookie cookie = new Cookie(\"sessionID\", \"123456\"); // 쿠키 이름과 값 설정        cookie.setHttpOnly(true); // HttpOnly 속성 설정 (JavaScript에서 접근 불가능)        cookie.setSecure(true); // HTTPS 환경에서만 쿠키 전송 (보안 강화)        cookie.setPath(\"/\"); // 쿠키가 전체 도메인에서 유효하도록 설정        cookie.setMaxAge(60 * 60); // 쿠키 유효 시간: 1시간 (초 단위)        response.addCookie(cookie); // 응답에 쿠키 추가        return \"HttpOnly 쿠키가 설정되었습니다!\";    }    // 위에 setCookie와 아래 setCookieWithHeader는 똑같은 결과. 둘 중 하나를 사용    @GetMapping(\"/set-cookie-header\")    public String setCookieWithHeader(HttpServletResponse response) {        response.setHeader(\"Set-Cookie\",             \"sessionID=123456; HttpOnly; Secure; Path=/; Max-Age=3600\");        return \"HttpOnly 쿠키가 응답 헤더에 설정되었습니다!\";    }}\n\n&nbsp;&nbsp;&nbsp;&nbsp;3. Content Security Policy(CSP) 적용 🫰\n웹사이트에 아래의 &lt;meta&gt; tag를 한 줄 넣어주는 주는 것으로도, 기본적인 XSS를 예방할 수 있습니다.🫡 코드의 세부적인 의미는 아래와 같습니다. \n  csphtml&lt;meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self' https://apis.trusteddomain.com\"&gt;\n\nhttp-equiv=&quot;Content-Security-Policy&quot; \n\n👉 브라우저에게 CSP 정책을 적용하라고 지시함.\n\n content=&quot;...&quot;\n\n👉 적용할 CSP 정책을 정의.\n\n default-src &#39;self&#39;\n\n👉 현재 웹사이트에서 제공하는 리소스(스크립트, 이미지, 스타일 등)만 로드 가능.&nbsp;&nbsp; 외부 도메인에서 로드하는 리소스는 기본적으로 차단됨. \n\n script-src &#39;self&#39; https://apis.trusteddomain.com\n\n👉&nbsp;&nbsp;’self’ - 현재 웹사이트에서 제공하는 스크립트만 허용.👉&nbsp;&nbsp;https://apis.trusteddomain.com - 이 특정 외부 도메인에서 제공하는 스크립트는 허용.     다른 외부 도메인의 스크립트는 차단됨.\n\n\n더 많은 옵션들이 있지만, CSP는 이정도만 알아보기로 하겠습니다!\n\n\n\n\n2. CSRF (Cross-Site Request Forgery) 방지\n자, 이번엔 CSRF 공격을 방지하는 방법에 대해 살펴 보겠습니다. Part. 2에서 CSRF를 방어하는 방법으로 설명드렸던 Referer 체크하기는 CSRF 공격이 아닌데도 Referer가 실제로 없는 경우가 있을 수 있기 때문에. 항상 CSRF 공격인지 여부를 반별할 수 있는 방법은 아닙니다.🙅\n사용자가 직접 URL을 입력해서 최초 입력을 하는 경우, 최초 웹사이트에 접속했기 때문에 Referer가 없을 수 있고, 고객의 개인정보에 민감한 사이트들은 고객의 행동을 추적하는 것을 방지하기 때문에 Referer를 날려버릴 수도 있어요.🫢 \n이런 경우까지도 모두 Referer가 없다고 CSRF 공격으로 간주해서는 안되겠죠? 그래서 아래와 같은 방법들을 사용해서 CSRF를 방어합니다.\n\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;1. CSRF 토큰 사용 🎫\n가장 효과적으로 CSRF 공격을 방지 하는 방법은 클라이언트가 보내는 모든 요청에 서버가 생성한 CSRF 토큰을 포함해야만 처리되도록 설정하는 것입니다!\nToken은 기본적으로 아주 긴 문자열의 형태를 가지고 있다고 했었죠! 서버는 랜덤&#x2F;복잡한 규칙으로 이 CSRF 토큰을 생성하여 아래의 순서로 CSRF 토큰을 검증합니다. \n\n유저가 로그인할 때 Session정보와 함께 클라이언트에게 전달하고,\n특정 API가 실행될 때(e.g. 송금하기)는 받았던 CSRF 토큰을 항상 함께 넣어줍니다.\n서버가 Client로부터 받은 CSRF 토큰을 서버의 토큰과 비교&amp;인증이 성공하면 해당 요청을 실행합니다.\n\n\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 어..? 근데 잠깐만.\n자, 근데 바로 여기서..! 여기까지 잘 따라오신 분들이라면 이런 질문이 드실 수도 있으실거에요. \n&nbsp;&nbsp; ???: “아니.. 근데 그 CSRF 토큰도 XSS 공격으로 털리면(?).. 해커가 CSRF 토큰도 사용하고 유저 쿠키도 사용해서 CSRF 방어가 안되는 거 아닌가..??”🤔\n\n\n그렇습니다.. 그렇기 때문에 CSRF 토큰을 서버가 브라우저(=Front-end)로 전달할 때에는 꼭, HttpOnly + Secure 쿠키로 꼭 전달해야합니다!! JavaScript로 탈취하더라도 토큰 내용이 무엇인지 알 수 없도록 말이죠! (위에서 먼저 설명한 이유..후후..😎)\n\n&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example ✍️\nSpringBoot에서 CSRF 토큰을 안전하게 쿠키로 전달하는 예시코드입니다. :)\n  springbootjavaimport org.springframework.http.ResponseCookie;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RestController;import jakarta.servlet.http.HttpServletResponse;@RestControllerpublic class CsrfController {        @GetMapping(\"/api/csrf-token\")    public String getCsrfToken(HttpServletResponse response) {        String csrfToken = generateSecureToken(); // CSRF 토큰 생성        ResponseCookie cookie = ResponseCookie.from(\"XSRF-TOKEN\", csrfToken)            .httpOnly(true)  // JavaScript에서 접근 불가            .secure(true)    // HTTPS에서만 전송            .sameSite(\"Strict\") // 다른 도메인에서는 사용 불가            .path(\"/\") // 모든 경로에서 유효            .build();        response.addHeader(\"Set-Cookie\", cookie.toString());        return \"CSRF Token Issued\";    }    private String generateSecureToken() {        return java.util.UUID.randomUUID().toString();    }}\n\n이렇게하면 CSRF 토큰을 받은 사용자도 CSRF 토큰이 무엇인지는 알 수 없으나.. 받은 그대로 탑재만해서 API요청을 하면 되니까 문제가 없습니다!😁\n\n\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;2. SameSite 쿠키 설정 ✅\nHttpOnly와 Secure 설정을 했던 것처럼 쿠키에 SameSite&#x3D;Strict 옵션을 주게되면, 방금까지 사용하던 웹페이지가 아닌 다른 URL에서 쿠키를 사용해서 요청(Request)을 보내는지 &#x3D; 문자그대로 “Same Site” 여부를 체크하고, 같은 곳이 아닐 경우, 인증이 끝난 사용자의 쿠키 전송을 자동으로 방지해줍니다.👮\n&nbsp;&nbsp; Set-Cookie: sessionid&#x3D;abc123; SameSite&#x3D;Strict\n\n\nSpringBoot 설정 예시는 CSRF 토큰 예시에 함께 적혀있으니 참고 부탁드려요.😚\n\n\n\n3. SSRF (Server-Side Request Forgery) 방지\n마지막으로 SSRF 방지 방법 2가지만 간단하게 알아보고, 포스팅을 마치도록 할게요! Part. 2에서도 언급했었던, 외부도메인만 허용하게 하는 방법과, Allowlist 방식을 적용해서 허용된 도메인만 API를 호출할 수 있게 세팅하는 방법이에요 :)\n\n&nbsp;&nbsp;&nbsp;&nbsp;1.  내부 IP 요청 차단 ✋\n아래와 같이 내부망 네트워크일 때 시작되는 127, 172, 192로 IP가 시작하고 있지는 않는지 체크해서 외부도메인만 허용하는 JS 예시코드입니다. 아래와 같은 로직으로 각 서버 언어와 문법에 맞게 작성하시면 되겠죠?😇  node.jsjavascriptconst isInternalIP = (url) =&gt; {    return /^(127\\.0\\.0\\.1|192\\.168\\.|10\\.)/.test(url);};app.get('/fetch', (req, res) =&gt; {    const url = req.query.url;    if (isInternalIP(url)) {        return res.status(403).send('내부망 요청 차단됨');    }    fetch(url).then(response =&gt; res.send(response.data));});\n\n&nbsp;&nbsp;&nbsp;&nbsp;2. Allowlist 방식 적용 ✅\n아래와 예시 코드의 로직과 같이 신뢰할 수 있는 특정 도메인만 요청할 수 있도록 설정하고 있습니다.   node.jsjavascriptconst ALLOWED_DOMAINS = ['https://trusted.com', 'https://api.safe.com'];app.get('/fetch', (req, res) =&gt; {  const url = req.query.url;  if (!ALLOWED_DOMAINS.some(domain =&gt; url.startsWith(domain))) {    return res.status(403).send('허용되지 않은 도메인');  }  fetch(url).then(response =&gt; res.send(response.data));});\n\n\n* 자, 그럼 여기까지해서.. Web Auth & Security 시리즈의 막을 내려보도록 하겠습니다.🎪 \n\n&nbsp;&nbsp;&nbsp;&nbsp; 읽어주셔서 감사합니다!🙇🏻‍♂️\n\nReferences\n&nbsp;&nbsp; yiwoojung&#39;s velog, SCB개발자이야기\n\n","dateCreated":"2025-02-15T22:52:43+09:00","dateModified":"2025-02-19T20:54:46+09:00","datePublished":"2025-02-15T22:52:43+09:00","description":"\n\n웹 보안취약점 보완하기 🔐\nPart.1 + Part.2 &#x3D; Part. 3 💫\n","headline":"Web Auth & Security 👮‍♂️ Part. 3","image":["cover.webp","cover.webp"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://petercha90.github.io/2025/02/15/authentication-3/"},"publisher":{"@type":"Organization","name":"Peter Cha","sameAs":[],"image":"peter.webp","logo":{"@type":"ImageObject","url":"peter.webp"}},"url":"https://petercha90.github.io/2025/02/15/authentication-3/","keywords":"tutorial, XSS, CSRF, SSRF, authentication, token, session, cookies","thumbnailUrl":"cover.webp"}</script>
    <meta name="description" content="웹 보안취약점 보완하기 🔐 Part.1 + Part.2 &#x3D; Part. 3 💫">
<meta property="og:type" content="blog">
<meta property="og:title" content="Web Auth &amp; Security 👮‍♂️ Part. 3">
<meta property="og:url" content="https://petercha90.github.io/2025/02/15/authentication-3/index.html">
<meta property="og:site_name" content="Peter&#39;s Place">
<meta property="og:description" content="웹 보안취약점 보완하기 🔐 Part.1 + Part.2 &#x3D; Part. 3 💫">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-02-15T13:52:43.000Z">
<meta property="article:modified_time" content="2025-02-19T11:54:46.399Z">
<meta property="article:author" content="Peter Cha">
<meta property="article:tag" content="tutorial">
<meta property="article:tag" content="XSS">
<meta property="article:tag" content="CSRF">
<meta property="article:tag" content="SSRF">
<meta property="article:tag" content="authentication">
<meta property="article:tag" content="token">
<meta property="article:tag" content="session">
<meta property="article:tag" content="cookies">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://petercha90.github.io/assets/images/peter.webp"/>
    
    
        <meta property="og:image" content="https://petercha90.github.io/2025/02/15/authentication-3/cover.webp"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://petercha90.github.io/2025/02/15/authentication-3/cover.webp"/>
    
    
        <meta property="og:image" content="https://petercha90.github.io/2025/02/15/authentication-3/cover.webp"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://petercha90.github.io/2025/02/15/authentication-3/cover.webp"/>
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-yn9su5rny89orahfymzfa2u8byhysd8o72yfaznhspafvar2rewhkawm6lky.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DFMCMD9E8V"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-DFMCMD9E8V');
    </script>


    

    
        
    
<style>
    figure.codeblock {
       margin: 0;
    }
    figure figcaption .tabs {
      display: flex;
      margin: 0;
    }
    figure figcaption .tabs .tab {
      cursor: pointer;
      list-style: none;
      padding: 5px 15px;
    }
    figure figcaption .tabs .tab.active {
      background: #2d2d2d;
      color: white;
    }
  </style></head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Peter&#39;s Place
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/peter.webp" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/peter.webp" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Peter Cha</h4>
                <!-- 
                    <h5 class="sidebar-profile-bio"><p>author.bio</p>
</h5>
                 -->
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Search tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/visitors-book"
                            
                            rel="noopener"
                            title="Visitors&#39; book"
                        >
                        <i class="sidebar-button-icon fa fa-book" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Visitors&#39; book</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/petercha90/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-center
                    post-header-cover--partial"
             style="background-image:url('/2025/02/15/authentication-3/cover.webp');"
             data-behavior="4">
            
        </div>

            <div style="background: rgba(255,255,255,0.94);" id="main" data-behavior="4"
                 class="hasCover
                        hasCoverMetaOut
                        hasCoverCaption">
                
<article class="post">
    
        <span class="post-header-cover-caption caption">웹 보안취약점 보완하기</span>
    
    
        <div class="post-header main-content-wrap text-center">
    
        <h1 class="post-title">
            Web Auth &amp; Security 👮‍♂️ Part. 3
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2025-02-15T22:52:43+09:00">
	
		    Feb 15, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/tutorial/">tutorial</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <!-- excerpt -->

<br>

<ul>
<li>안녕하세요, PETER입니다.👋 이번 포스팅에서는 <a href="https://petercha90.github.io/2025/02/01/authentication_/">Part. 1</a>과 <a href="https://petercha90.github.io/2025/02/13/authentication-2/">Part. 2</a> 내용을 모두 이해하고 있다는 전제 하에, 웹 취약점들을 쿠키 세션 토큰을 가지고 어떻게 조치할 수 있는지. Part. 2에서 나누지 못했던 방법들을 더 알아보기로 하겠습니다.🤗</li>
</ul>
<hr>

<h2 id="1-XSS-Cross-Site-Scripting-방지"><a href="#1-XSS-Cross-Site-Scripting-방지" class="headerlink" title="1. XSS (Cross-Site Scripting) 방지"></a>1. XSS (Cross-Site Scripting) 방지</h2><h4 id="nbsp-nbsp-🥠-쿠키-관련-보안-설정"><a href="#nbsp-nbsp-🥠-쿠키-관련-보안-설정" class="headerlink" title="&nbsp;&nbsp; 🥠 쿠키 관련 보안 설정"></a>&nbsp;&nbsp; 🥠 쿠키 관련 보안 설정</h4><ul>
<li><p><a href="https://petercha90.github.io/2025/02/01/authentication_/">Part. 1</a>에서 Cookie를 설명하면서, 개발자도구 - Console창에서 <code>document.cookie</code>라는 JavaScript를 입력하면 바로 브라우저에 저장된 Cookie들이 모두 출력이 된다는 사실! 기억나시나요?!</p>
</li>
<li><p>이 말인즉슨, XSS 취약점이 있는 경우, JavaScript를 사용해서 쿠키 정보를 해커가 탈취할 수 있다는 말이 됩니다!🙀 하지만 XSS 취약점이 있는 상황에도 쿠키에 JavaScript를 사용해서 쿠키 내용에 접근할 수 없게하는 방법이 있으니, 바로 <code>HttpOnly</code>와, <code>Secure</code> 설정 되시겠습니다.😎</p>
</li>
</ul>
<h4 id="nbsp-nbsp-nbsp-nbsp-1-HttpOnly-🤫"><a href="#nbsp-nbsp-nbsp-nbsp-1-HttpOnly-🤫" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;1. HttpOnly 🤫"></a>&nbsp;&nbsp;&nbsp;&nbsp;1. HttpOnly 🤫</h4><ul>
<li><p>아래와 같이 Cookie를 서버에서 클라이언트로 보내줄 때, HttpOnly 설정을 해주면 실제로는 해당 쿠키가 브라우저에 저장이 잘 됐지만, 클라이언트인 브라우저 단에서는 <code>console.log(document.cookie)</code> 등과 같이 JavaScript로 출력해도 아무것도 출력되지 않아 쿠키 내용을 알 수 없게 됩니다! 👍</p>
<blockquote>
<p>&nbsp;&nbsp;Set-Cookie: sessionid&#x3D;abc123; <strong>HttpOnly</strong></p>
</blockquote>
</li>
</ul>
<h4 id="nbsp-nbsp-nbsp-nbsp-2-Secure-👮"><a href="#nbsp-nbsp-nbsp-nbsp-2-Secure-👮" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;2. Secure 👮"></a>&nbsp;&nbsp;&nbsp;&nbsp;2. Secure 👮</h4><ul>
<li><p>Secure 옵션을 사용하면, Https로 인증된 사이트에서만 쿠키를 사용할 수 있게(&#x3D;브라우저에서 서버로 전송할 수 있게)해줘서, 보안이 취약한 HTTP 사이트에서는 쿠키가 전송되지 않습니다. 이렇게 해주면 해커가 탈취한다한들 사용할 수 없겠죠? 😼</p>
<blockquote>
<p>&nbsp;&nbsp;Set-Cookie: sessionid&#x3D;abc123; <strong>Secure</strong></p>
</blockquote>
</li>
</ul>
<h6 id="nbsp-nbsp-nbsp-nbsp-SpringBoot-example-✍️"><a href="#nbsp-nbsp-nbsp-nbsp-SpringBoot-example-✍️" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example ✍️"></a>&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example ✍️</h6><ul>
<li>그렇다면 HttpOnly, Secure 옵션들은 어디서 설정해야 할까요? 정보를 담아서 보내주는 서버가 해줘야 합니다! 아래는 두 옵션을 적용하는 두 가지 SpringBoot 예시에요. 마찬가지로 서비스를 제공하는 서버가 Django든, node.js든 해당 서버의 방식대로 아래와 같이 쿠키에 설정을 해줘서 보내주면 되겠죠?<ul>
<li>Spring Security를 사용하면 자동으로 JSESSIONID 쿠키에 HttpOnly 속성이 적용된다고하니, 참고하세요!😉</li>
</ul>
  <figure class="codeblock codeblock--tabbed"><figcaption><span>springboot</span><ul class="tabs"><li class="tab active">java</li></ul></figcaption><div class="tabs-content"><figure class="highlight java" style="display: block;"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CookieController</span> {</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping("/set-cookie")</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">setCookie</span><span class="params">(HttpServletResponse response)</span> {</span><br><span class="line">        <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">"sessionID"</span>, <span class="string">"123456"</span>); <span class="comment">// 쿠키 이름과 값 설정</span></span><br><span class="line">        cookie.setHttpOnly(<span class="literal">true</span>); <span class="comment">// HttpOnly 속성 설정 (JavaScript에서 접근 불가능)</span></span><br><span class="line">        cookie.setSecure(<span class="literal">true</span>); <span class="comment">// HTTPS 환경에서만 쿠키 전송 (보안 강화)</span></span><br><span class="line">        cookie.setPath(<span class="string">"/"</span>); <span class="comment">// 쿠키가 전체 도메인에서 유효하도록 설정</span></span><br><span class="line">        cookie.setMaxAge(<span class="number">60</span> * <span class="number">60</span>); <span class="comment">// 쿠키 유효 시간: 1시간 (초 단위)</span></span><br><span class="line"></span><br><span class="line">        response.addCookie(cookie); <span class="comment">// 응답에 쿠키 추가</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"HttpOnly 쿠키가 설정되었습니다!"</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 위에 setCookie와 아래 setCookieWithHeader는 똑같은 결과. 둘 중 하나를 사용</span></span><br><span class="line">    <span class="meta">@GetMapping("/set-cookie-header")</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">setCookieWithHeader</span><span class="params">(HttpServletResponse response)</span> {</span><br><span class="line">        response.setHeader(<span class="string">"Set-Cookie"</span>, </span><br><span class="line">            <span class="string">"sessionID=123456; HttpOnly; Secure; Path=/; Max-Age=3600"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"HttpOnly 쿠키가 응답 헤더에 설정되었습니다!"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div></figure></li>
</ul>
<h4 id="nbsp-nbsp-nbsp-nbsp-3-Content-Security-Policy-CSP-적용-🫰"><a href="#nbsp-nbsp-nbsp-nbsp-3-Content-Security-Policy-CSP-적용-🫰" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;3. Content Security Policy(CSP) 적용 🫰"></a>&nbsp;&nbsp;&nbsp;&nbsp;3. Content Security Policy(CSP) 적용 🫰</h4><ul>
<li><p>웹사이트에 아래의 <code>&lt;meta&gt;</code> tag를 한 줄 넣어주는 주는 것으로도, 기본적인 XSS를 예방할 수 있습니다.🫡 코드의 세부적인 의미는 아래와 같습니다. </p>
  <figure class="codeblock codeblock--tabbed"><figcaption><span>csp</span><ul class="tabs"><li class="tab active">html</li></ul></figcaption><div class="tabs-content"><figure class="highlight html" style="display: block;"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Security-Policy"</span> <span class="attr">content</span>=<span class="string">"default-src 'self'; script-src 'self' https://apis.trusteddomain.com"</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></div></figure>
</li>
<li><p><code>http-equiv=&quot;Content-Security-Policy&quot;</code> </p>
<blockquote>
<p>👉 브라우저에게 CSP 정책을 적용하라고 지시함.</p>
</blockquote>
<p> <code>content=&quot;...&quot;</code></p>
<blockquote>
<p>👉 적용할 CSP 정책을 정의.</p>
</blockquote>
<p> <code>default-src &#39;self&#39;</code></p>
<blockquote>
<p>👉 현재 웹사이트에서 제공하는 리소스(스크립트, 이미지, 스타일 등)만 로드 가능.<br>&nbsp;&nbsp; 외부 도메인에서 로드하는 리소스는 기본적으로 차단됨. </p>
</blockquote>
<p> <code>script-src &#39;self&#39; https://apis.trusteddomain.com</code></p>
<blockquote>
<p>👉&nbsp;&nbsp;’self’ - 현재 웹사이트에서 제공하는 스크립트만 허용.<br>👉&nbsp;&nbsp;<a target="_blank" rel="noopener" href="https://apis.trusteddomain.com/">https://apis.trusteddomain.com</a> - 이 특정 외부 도메인에서 제공하는 스크립트는 허용.     다른 외부 도메인의 스크립트는 차단됨.</p>
</blockquote>
</li>
<li><p>더 많은 옵션들이 있지만, CSP는 이정도만 알아보기로 하겠습니다!</p>
</li>
</ul>
<Br>

<h2 id="2-CSRF-Cross-Site-Request-Forgery-방지"><a href="#2-CSRF-Cross-Site-Request-Forgery-방지" class="headerlink" title="2. CSRF (Cross-Site Request Forgery) 방지"></a>2. CSRF (Cross-Site Request Forgery) 방지</h2><ul>
<li>자, 이번엔 CSRF 공격을 방지하는 방법에 대해 살펴 보겠습니다. Part. 2에서 CSRF를 방어하는 방법으로 설명드렸던 <code>Referer 체크하기</code>는 CSRF 공격이 아닌데도 Referer가 실제로 없는 경우가 있을 수 있기 때문에. 항상 CSRF 공격인지 여부를 반별할 수 있는 방법은 아닙니다.🙅</li>
<li>사용자가 직접 URL을 입력해서 최초 입력을 하는 경우, 최초 웹사이트에 접속했기 때문에 Referer가 없을 수 있고, 고객의 개인정보에 민감한 사이트들은 고객의 행동을 추적하는 것을 방지하기 때문에 Referer를 날려버릴 수도 있어요.🫢 </li>
<li>이런 경우까지도 모두 Referer가 없다고 CSRF 공격으로 간주해서는 안되겠죠? 그래서 아래와 같은 방법들을 사용해서 CSRF를 방어합니다.</li>
</ul>
<hr>

<h4 id="nbsp-nbsp-nbsp-nbsp-1-CSRF-토큰-사용-🎫"><a href="#nbsp-nbsp-nbsp-nbsp-1-CSRF-토큰-사용-🎫" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;1. CSRF 토큰 사용 🎫"></a>&nbsp;&nbsp;&nbsp;&nbsp;1. CSRF 토큰 사용 🎫</h4><ul>
<li>가장 효과적으로 CSRF 공격을 방지 하는 방법은 <strong><span class="highlight-text" style="background-color:#FFDFB8;"><u>클라이언트가 보내는 모든 요청에 서버가 생성한 CSRF 토큰을 포함해야만 처리되도록 설정하는 것입니다!</u></span></strong></li>
<li>Token은 기본적으로 아주 긴 문자열의 형태를 가지고 있다고 했었죠! 서버는 랜덤&#x2F;복잡한 규칙으로 이 CSRF 토큰을 생성하여 아래의 순서로 CSRF 토큰을 검증합니다. <blockquote>
<ol>
<li>유저가 로그인할 때 Session정보와 함께 클라이언트에게 전달하고,</li>
<li>특정 API가 실행될 때(e.g. 송금하기)는 받았던 CSRF 토큰을 항상 함께 넣어줍니다.</li>
<li>서버가 Client로부터 받은 CSRF 토큰을 서버의 토큰과 비교&amp;인증이 성공하면 해당 요청을 실행합니다.</li>
</ol>
</blockquote>
</li>
</ul>
<h6 id="nbsp-nbsp-nbsp-nbsp-nbsp-어-근데-잠깐만"><a href="#nbsp-nbsp-nbsp-nbsp-nbsp-어-근데-잠깐만" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 어..? 근데 잠깐만."></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 어..? 근데 잠깐만.</h6><ul>
<li>자, 근데 바로 여기서..! 여기까지 잘 따라오신 분들이라면 이런 질문이 드실 수도 있으실거에요. <blockquote>
<p>&nbsp;&nbsp; ???: “아니.. 근데 그 CSRF 토큰도 XSS 공격으로 털리면(?).. 해커가 CSRF 토큰도 사용하고 유저 쿠키도 사용해서 CSRF 방어가 안되는 거 아닌가..??”🤔</p>
</blockquote>
</li>
<li>그렇습니다.. 그렇기 때문에 <u><strong><span class="highlight-text" style="background-color:#cae9ea;">CSRF 토큰을 서버가 브라우저(=Front-end)로 전달할 때에는 꼭, HttpOnly + Secure 쿠키로 꼭 전달해야합니다!!</span></strong></u> JavaScript로 탈취하더라도 토큰 내용이 무엇인지 알 수 없도록 말이죠! (위에서 먼저 설명한 이유..후후..😎)</li>
</ul>
<h6 id="nbsp-nbsp-nbsp-nbsp-SpringBoot-example-✍️-1"><a href="#nbsp-nbsp-nbsp-nbsp-SpringBoot-example-✍️-1" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example ✍️"></a>&nbsp;&nbsp;&nbsp;&nbsp; SpringBoot example ✍️</h6><ul>
<li><p>SpringBoot에서 CSRF 토큰을 안전하게 쿠키로 전달하는 예시코드입니다. :)</p>
  <figure class="codeblock codeblock--tabbed"><figcaption><span>springboot</span><ul class="tabs"><li class="tab active">java</li></ul></figcaption><div class="tabs-content"><figure class="highlight java" style="display: block;"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.http.ResponseCookie;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CsrfController</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping("/api/csrf-token")</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCsrfToken</span><span class="params">(HttpServletResponse response)</span> {</span><br><span class="line">        <span class="type">String</span> <span class="variable">csrfToken</span> <span class="operator">=</span> generateSecureToken(); <span class="comment">// CSRF 토큰 생성</span></span><br><span class="line"></span><br><span class="line">        <span class="type">ResponseCookie</span> <span class="variable">cookie</span> <span class="operator">=</span> ResponseCookie.from(<span class="string">"XSRF-TOKEN"</span>, csrfToken)</span><br><span class="line">            .httpOnly(<span class="literal">true</span>)  <span class="comment">// JavaScript에서 접근 불가</span></span><br><span class="line">            .secure(<span class="literal">true</span>)    <span class="comment">// HTTPS에서만 전송</span></span><br><span class="line">            .sameSite(<span class="string">"Strict"</span>) <span class="comment">// 다른 도메인에서는 사용 불가</span></span><br><span class="line">            .path(<span class="string">"/"</span>) <span class="comment">// 모든 경로에서 유효</span></span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">        response.addHeader(<span class="string">"Set-Cookie"</span>, cookie.toString());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"CSRF Token Issued"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">generateSecureToken</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> java.util.UUID.randomUUID().toString();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div></figure>
</li>
<li><p>이렇게하면 CSRF 토큰을 받은 사용자도 CSRF 토큰이 무엇인지는 알 수 없으나.. 받은 그대로 탑재만해서 API요청을 하면 되니까 문제가 없습니다!😁</p>
</li>
</ul>
<br>

<h4 id="nbsp-nbsp-nbsp-nbsp-2-SameSite-쿠키-설정-✅"><a href="#nbsp-nbsp-nbsp-nbsp-2-SameSite-쿠키-설정-✅" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;2. SameSite 쿠키 설정 ✅"></a>&nbsp;&nbsp;&nbsp;&nbsp;2. SameSite 쿠키 설정 ✅</h4><ul>
<li>HttpOnly와 Secure 설정을 했던 것처럼 쿠키에 SameSite&#x3D;Strict 옵션을 주게되면, 방금까지 사용하던 웹페이지가 아닌 다른 URL에서 쿠키를 사용해서 요청(Request)을 보내는지 &#x3D; 문자그대로 “Same Site” 여부를 체크하고, 같은 곳이 아닐 경우, 인증이 끝난 사용자의 쿠키 전송을 자동으로 방지해줍니다.👮<blockquote>
<p>&nbsp;&nbsp; Set-Cookie: sessionid&#x3D;abc123; <strong>SameSite&#x3D;Strict</strong></p>
</blockquote>
</li>
<li>SpringBoot 설정 예시는 CSRF 토큰 예시에 함께 적혀있으니 참고 부탁드려요.😚</li>
</ul>
<br>

<h2 id="3-SSRF-Server-Side-Request-Forgery-방지"><a href="#3-SSRF-Server-Side-Request-Forgery-방지" class="headerlink" title="3. SSRF (Server-Side Request Forgery) 방지"></a>3. SSRF (Server-Side Request Forgery) 방지</h2><ul>
<li>마지막으로 SSRF 방지 방법 2가지만 간단하게 알아보고, 포스팅을 마치도록 할게요! Part. 2에서도 언급했었던, 외부도메인만 허용하게 하는 방법과, Allowlist 방식을 적용해서 허용된 도메인만 API를 호출할 수 있게 세팅하는 방법이에요 :)</li>
</ul>
<h4 id="nbsp-nbsp-nbsp-nbsp-1-내부-IP-요청-차단-✋"><a href="#nbsp-nbsp-nbsp-nbsp-1-내부-IP-요청-차단-✋" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;1.  내부 IP 요청 차단 ✋"></a>&nbsp;&nbsp;&nbsp;&nbsp;1.  내부 IP 요청 차단 ✋</h4><ul>
<li>아래와 같이 내부망 네트워크일 때 시작되는 127, 172, 192로 IP가 시작하고 있지는 않는지 체크해서 외부도메인만 허용하는 JS 예시코드입니다. 아래와 같은 로직으로 각 서버 언어와 문법에 맞게 작성하시면 되겠죠?😇  <figure class="codeblock codeblock--tabbed"><figcaption><span>node.js</span><ul class="tabs"><li class="tab active">javascript</li></ul></figcaption><div class="tabs-content"><figure class="highlight javascript" style="display: block;"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">isInternalIP</span> = (<span class="params">url</span>) =&gt; {</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/^(127\.0\.0\.1|192\.168\.|10\.)/</span>.<span class="title function_">test</span>(url);</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">'/fetch'</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> url = req.<span class="property">query</span>.<span class="property">url</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isInternalIP</span>(url)) {</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(<span class="string">'내부망 요청 차단됨'</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="title function_">fetch</span>(url).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> res.<span class="title function_">send</span>(response.<span class="property">data</span>));</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure></div></figure></li>
</ul>
<h4 id="nbsp-nbsp-nbsp-nbsp-2-Allowlist-방식-적용-✅"><a href="#nbsp-nbsp-nbsp-nbsp-2-Allowlist-방식-적용-✅" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp;2. Allowlist 방식 적용 ✅"></a>&nbsp;&nbsp;&nbsp;&nbsp;2. Allowlist 방식 적용 ✅</h4><ul>
<li>아래와 예시 코드의 로직과 같이 신뢰할 수 있는 특정 도메인만 요청할 수 있도록 설정하고 있습니다.   <figure class="codeblock codeblock--tabbed"><figcaption><span>node.js</span><ul class="tabs"><li class="tab active">javascript</li></ul></figcaption><div class="tabs-content"><figure class="highlight javascript" style="display: block;"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">ALLOWED_DOMAINS</span> = [<span class="string">'https://trusted.com'</span>, <span class="string">'https://api.safe.com'</span>];</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">'/fetch'</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> {</span><br><span class="line">  <span class="keyword">const</span> url = req.<span class="property">query</span>.<span class="property">url</span>;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable constant_">ALLOWED_DOMAINS</span>.<span class="title function_">some</span>(<span class="function"><span class="params">domain</span> =&gt;</span> url.<span class="title function_">startsWith</span>(domain))) {</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(<span class="string">'허용되지 않은 도메인'</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="title function_">fetch</span>(url).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> res.<span class="title function_">send</span>(response.<span class="property">data</span>));</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure></div></figure></li>
</ul>
<hr>
* 자, 그럼 여기까지해서.. Web Auth & Security 시리즈의 막을 내려보도록 하겠습니다.🎪 

<h6 id="nbsp-nbsp-nbsp-nbsp-읽어주셔서-감사합니다-🙇🏻‍♂️"><a href="#nbsp-nbsp-nbsp-nbsp-읽어주셔서-감사합니다-🙇🏻‍♂️" class="headerlink" title="&nbsp;&nbsp;&nbsp;&nbsp; 읽어주셔서 감사합니다!🙇🏻‍♂️"></a>&nbsp;&nbsp;&nbsp;&nbsp; 읽어주셔서 감사합니다!🙇🏻‍♂️</h6><br>

<h5 id="References"><a href="#References" class="headerlink" title="References"></a>References</h5><blockquote>
<p>&nbsp;&nbsp; <a target="_blank" rel="noopener" href="https://velog.io/@eeeve/HttpOnly%EC%99%80-Secure-Cookie"><code>yiwoojung&#39;s velog</code></a>, <a target="_blank" rel="noopener" href="https://devscb.tistory.com/123"><code>SCB개발자이야기</code></a></p>
</blockquote>
<br>
            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        <center><a target="_blank" rel="noopener" href="https://www.buymeacoffee.com/petercha"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=petercha&button_colour=FFDD00&font_colour=000000&font_family=Bree&outline_colour=000000&coffee_colour=ffffff" /></a></center>
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/CSRF/" rel="tag">CSRF</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/SSRF/" rel="tag">SSRF</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/XSS/" rel="tag">XSS</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/authentication/" rel="tag">authentication</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/cookies/" rel="tag">cookies</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/session/" rel="tag">session</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/token/" rel="tag">token</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/tutorial/" rel="tag">tutorial</a>

            </div>
        
        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Peter Cha. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/peter.webp" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Peter Cha</h4>
        
            <div style="margin-top: -5%" id="about-card-bio"> A normal developer.
        
        
                <br> <br>
                📭 &nbsp;
                 petercha90@gmail.com
                <br/>
            </div>
            
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.webp');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-oucp2gddrcsezh9z9ulhreq7falixqmvy4hwsvswurwz0zjkzlygrbowakam.min.js"></script>

<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'https://petercha90.github.io/2025/02/15/authentication-3/';
              
            this.page.identifier = '2025/02/15/authentication-3/';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'petercha90';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    <script>
  $(document).ready(function() {
    $('figure.codeblock').find('.tab').click(function() {
        var $codeblock = $(this).parent().parent().parent();
        var $tab = $(this);
        // remove "active" css class on all tabs
        $tab.siblings().removeClass('active');
        // add "active" css class on the clicked tab
        $tab.addClass('active');
        // hide all tab contents
        $codeblock.find('.highlight').hide();
        // show only the right one
        $codeblock.find('.highlight.' + $tab.text()).show();
    });
  });
  </script></body>
</html>
